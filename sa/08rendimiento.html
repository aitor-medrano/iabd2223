
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aitor-medrano.github.io/iabd2223/sa/08rendimiento.html">
      
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.14">
    
    
      
        <title>Rendimiento - IABD</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-MFP4QLMMV7"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-MFP4QLMMV7",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-MFP4QLMMV7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Rendimiento - IABD" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://aitor-medrano.github.io/iabd2223/assets/images/social/sa/08rendimiento.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://aitor-medrano.github.io/iabd2223/sa/08rendimiento.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Rendimiento - IABD" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://aitor-medrano.github.io/iabd2223/assets/images/social/sa/08rendimiento.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rendimiento" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="IABD" class="md-header__button md-logo" aria-label="IABD" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IABD
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rendimiento
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="IABD" class="md-nav__button md-logo" aria-label="IABD" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    IABD
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="index.html">Sistemas de almacenamiento</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Sistemas de almacenamiento
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="01nosql.html" class="md-nav__link">
        Almacenamiento de datos. NoSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="02mongo.html" class="md-nav__link">
        MongoDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="03modelado.html" class="md-nav__link">
        Modelado de datos NoSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="05agregaciones.html" class="md-nav__link">
        Agregaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="06replicacion.html" class="md-nav__link">
        Replicación y Particionado
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="07pymongo.html" class="md-nav__link">
        MongoDB y Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../hadoop/index.html">Ecosistema Hadoop</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Ecosistema Hadoop
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/01arq.html" class="md-nav__link">
        Arquitecturas Big Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/02etl.html" class="md-nav__link">
        Ingesta de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/03hadoop.html" class="md-nav__link">
        Hadoop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/04hdfs.html" class="md-nav__link">
        HDFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/04formatos.html" class="md-nav__link">
        Formatos de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/05flume.html" class="md-nav__link">
        Sqoop y Flume
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/06hive.html" class="md-nav__link">
        Hive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../cloud/index.html">Datos en el cloud</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Datos en el cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/01cloud.html" class="md-nav__link">
        Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/02aws.html" class="md-nav__link">
        AWS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/03s3.html" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/04computacion.html" class="md-nav__link">
        EC2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/05emr.html" class="md-nav__link">
        EMR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/06datos.html" class="md-nav__link">
        RDS y DynamoDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/07athena.html" class="md-nav__link">
        Athena
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../spark/index.html">Spark</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Spark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/01spark.html" class="md-nav__link">
        Ecosistema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/01rdd.html" class="md-nav__link">
        RDD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02dataframeAPI.html" class="md-nav__link">
        DataFrames API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02agregaciones.html" class="md-nav__link">
        Agregaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02catalog.html" class="md-nav__link">
        Spark Catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/03streaming.html" class="md-nav__link">
        Streaming I
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/03join-window.html" class="md-nav__link">
        Streaming II
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../dataflow/index.html">Flujo de datos</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Flujo de datos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/04nifi1.html" class="md-nav__link">
        Nifi I
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/05nifi2.html" class="md-nav__link">
        Nifi II
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/02kafka.html" class="md-nav__link">
        Kafka I
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/03kafka.html" class="md-nav__link">
        Kafka II
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://aitor-medrano.github.io/pia2223/" class="md-nav__link">
        PIA FP
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#indices" class="md-nav__link">
    Índices
  </a>
  
    <nav class="md-nav" aria-label="Índices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simples" class="md-nav__link">
    Simples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compuestos" class="md-nav__link">
    Compuestos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiclave" class="md-nav__link">
    Multiclave
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rendimiento_1" class="md-nav__link">
    Rendimiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#colecciones-limitadas" class="md-nav__link">
    Colecciones limitadas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#profiling" class="md-nav__link">
    Profiling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    Referencias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    Actividades
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="rendimiento">Rendimiento<a class="headerlink" href="#rendimiento" title="Permanent link">&para;</a></h1>
<h2 id="indices">Índices<a class="headerlink" href="#indices" title="Permanent link">&para;</a></h2>
<p>Los índices son una parte importante de la gestión de bases de datos. Un índice en una base de datos es similar a un índice de un libro; permite saltar directamente a la parte del libro en vez de tener que pasar las páginas buscando el tema o la palabra que nos interesa.</p>
<p>En el caso de <em>MongoDB</em>, un índice es una estructura de datos que almacena información sobre los valor de determinados campos de los documentos de una colección. Esta estructura permite recorrer los datos y ordenarlos de manera muy rápida. Así pues, los índices se utilizan tanto al buscar un documento como al ordenar los datos de una consulta.</p>
<div class="admonition info">
<p class="admonition-title">Preparando los ejemplos</p>
<p>Para los siguientes ejemplos, vamos a utilizar una colección de 200 estudiantes con las calificaciones que han obtenido en diferentes trabajos, exámenes o cuestionarios.</p>
<p>Para ello, importaremos la colección <code>students.json</code> mediante:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>mongoimport<span class="w"> </span>-d<span class="w"> </span>expertojava<span class="w"> </span>-c<span class="w"> </span>students<span class="w"> </span>--file<span class="w"> </span>students.json
</code></pre></div>
<p>Un ejemplo de una estudiante sería:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="err">&gt;</span><span class="w"> </span><span class="err">db.s</span><span class="kc">tu</span><span class="err">de</span><span class="kc">nts</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">dO</span><span class="kc">ne</span><span class="err">()</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nt">&quot;_id&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nt">&quot;name&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;aimee Zank&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="nt">&quot;scores&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exam&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nt">&quot;score&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.463179736705023</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;quiz&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="nt">&quot;score&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">11.78273309957772</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;homework&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="nt">&quot;score&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">6.676176060654615</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;homework&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="nt">&quot;score&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">35.8740349954354</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">]</span>
<span class="linenos" data-linenos="20 "></span><span class="p">}</span>
</code></pre></div>
</div>
<p>Para comprobar el impacto del uso de índices, vamos a empezar con un ejemplo para ver cómo de rápido puede hacerse una consulta que tiene un índice respecto a uno que no lo tiene.</p>
<p>Para analizar el plan de ejecución de una consulta, podemos emplear el método <code>explain()</code> (https://docs.mongodb.org/manual/reference/method/cursor.explain/) sobre un cursor:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Kaila Deibler&quot;</span><span class="p">}).</span><span class="nx">explain</span><span class="p">(</span><span class="s2">&quot;executionStats&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="s2">&quot;queryPlanner&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="s2">&quot;plannerVersion&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="s2">&quot;namespace&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;expertojava.students&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="s2">&quot;indexFilterSet&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="s2">&quot;parsedQuery&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">      </span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;$eq&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Kaila Deibler&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">},</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="s2">&quot;winningPlan&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">      </span><span class="s2">&quot;stage&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;COLLSCAN&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span><span class="w">      </span><span class="s2">&quot;filter&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;$eq&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Kaila Deibler&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">      </span><span class="p">},</span>
<span class="linenos" data-linenos="15 "></span><span class="w">      </span><span class="s2">&quot;direction&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;forward&quot;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">},</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="s2">&quot;rejectedPlans&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span>
<span class="linenos" data-linenos="18 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="19 "></span><span class="w">  </span><span class="s2">&quot;executionStats&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="s2">&quot;executionSuccess&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="s2">&quot;nReturned&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="s2">&quot;executionTimeMillis&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="s2">&quot;totalKeysExamined&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="s2">&quot;totalDocsExamined&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="s2">&quot;executionStages&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="26 "></span><span class="w">      </span><span class="s2">&quot;stage&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;COLLSCAN&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="27 "></span><span class="w">      </span><span class="s2">&quot;filter&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;$eq&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Kaila Deibler&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="29 "></span><span class="w">      </span><span class="p">},</span>
<span class="linenos" data-linenos="30 "></span><span class="w">      </span><span class="s2">&quot;nReturned&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="31 "></span><span class="w">      </span><span class="s2">&quot;executionTimeMillisEstimate&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="linenos" data-linenos="32 "></span><span class="w">      </span><span class="s2">&quot;works&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">204</span><span class="p">,</span>
<span class="linenos" data-linenos="33 "></span><span class="w">      </span><span class="s2">&quot;advanced&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="34 "></span><span class="w">      </span><span class="s2">&quot;needTime&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">199</span><span class="p">,</span>
<span class="linenos" data-linenos="35 "></span><span class="w">      </span><span class="s2">&quot;needYield&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="36 "></span><span class="w">      </span><span class="s2">&quot;saveState&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="37 "></span><span class="w">      </span><span class="s2">&quot;restoreState&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="linenos" data-linenos="38 "></span><span class="w">      </span><span class="s2">&quot;isEOF&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos="39 "></span><span class="w">      </span><span class="s2">&quot;invalidates&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="linenos" data-linenos="40 "></span><span class="w">      </span><span class="s2">&quot;direction&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;forward&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="41 "></span><span class="w">      </span><span class="s2">&quot;docsExamined&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">200</span>
<span class="linenos" data-linenos="42 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="43 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="44 "></span><span class="w">  </span><span class="s2">&quot;serverInfo&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="45 "></span><span class="w">    </span><span class="s2">&quot;host&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;MacBook-Air-de-Aitor.local&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="46 "></span><span class="w">    </span><span class="s2">&quot;port&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">27017</span><span class="p">,</span>
<span class="linenos" data-linenos="47 "></span><span class="w">    </span><span class="s2">&quot;version&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;3.2.1&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="48 "></span><span class="w">    </span><span class="s2">&quot;gitVersion&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;a14d55980c2cdc565d4704a7e3ad37e4e535c1b2&quot;</span>
<span class="linenos" data-linenos="49 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="50 "></span><span class="w">  </span><span class="s2">&quot;ok&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span>
<span class="linenos" data-linenos="51 "></span><span class="p">}</span>
</code></pre></div>
<p>El plan de ejecución devuelve mucha información (https://docs.mongodb.org/manual/reference/explain-results/), pero nos vamos a centrar en unos pocos atributos para analizar el resultado.</p>
<p>A <em>grosso modo</em>, podemos observar como el resultado se divide en dos partes:</p>
<ul>
<li>queryPlanner: muestra información sobre la consulta, indicando el plan ganador en winningPlan</li>
<li>
<p>winningPlan.stage: muestra información de la acción realizada. Puede tomar los valores:</p>
</li>
<li>
<p><code>COLLSCAN</code>: escaneo completo de una colección</p>
</li>
<li><code>IXSCAN</code>: escaneo a partir de un índice</li>
<li><code>FETCH</code>: al recuperar documentos</li>
<li><code>SHARD_MERGE</code>: al fusionar resultados de las particiones</li>
<li><code>executionStats</code>: muestra estadísticas de ejecución</li>
<li><code>executionTimeMillis</code>: tiempo empleado</li>
</ul>
<p>Del resultado obtenido, se puede observar mediante la propiedad <code>queryPlanner.winningPlan.stage</code> que ha utilizado un <code>COLLSCAN</code>, lo que significa que se ha realizado un escaneo completo de toda la colección para encontrar los datos, es decir, no se ha usado ningún índice en la consulta. Esta consulta sólo devuelve un par de documentos (<code>executionStats.nReturned</code>) pero ha tenido que escanear los 200 existentes (<code>executionStats.totalDocsExamined</code>).</p>
<p>Cuando vamos a buscar un elemento, es mucho mas rápido hacer un <code>findOne</code> que <code>find</code>, porque mientras find recorre toda la colección, con <code>findOne</code> en cuanto encuentre un documento, el cursor se detendrá.
Por defecto, el campo <code>_id</code> esta indexado. Así pues, vamos a buscar el mismo documento de antes, pero ahora mediante el campo indexado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="mf">30</span><span class="p">}).</span><span class="nx">explain</span><span class="p">(</span><span class="s2">&quot;executionStats&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="s2">&quot;queryPlanner&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="s2">&quot;plannerVersion&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="p">...</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="s2">&quot;winningPlan&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">      </span><span class="s2">&quot;stage&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;IDHACK&quot;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">},</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="s2">&quot;rejectedPlans&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span>
<span class="linenos" data-linenos="10 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="11 "></span><span class="w">  </span><span class="s2">&quot;executionStats&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="s2">&quot;executionSuccess&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="s2">&quot;nReturned&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="s2">&quot;executionTimeMillis&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="s2">&quot;totalKeysExamined&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="s2">&quot;totalDocsExamined&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="s2">&quot;executionStages&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">      </span><span class="p">...</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="21 "></span><span class="w">  </span><span class="s2">&quot;serverInfo&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">...</span>
<span class="linenos" data-linenos="23 "></span><span class="w">  </span><span class="p">},</span>
<span class="linenos" data-linenos="24 "></span><span class="w">  </span><span class="s2">&quot;ok&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
<p>Ahora MongoDB sólo ha escaneado el documento que ha devuelto ( <code>executionStats.totalKeysExamined</code>), y ha utilizado un índice para acceder al campo <code>_id</code> (valor <code>IDHACK</code> en <code>winningPlan.stage</code>). Al haber utilizado un índice, hemos evitado tener que mirar en más documentos. Esta consulta se ha realizado más rápidamente (y a mayor número de documentos más se nota la diferencia). Por supuesto, no siempre vamos a buscar por su <code>_id</code>, así que vamos a ver como crear nuevos índices.</p>
<p>Toda la información sobre el uso de índices con <em>MongoDB</em> se encuentra en http://docs.mongodb.org/manual/core/indexes/</p>
<h3 id="simples">Simples<a class="headerlink" href="#simples" title="Permanent link">&para;</a></h3>
<p>Para crear un índice hemos de utilizar el método createIndex({atributo:orden})</p>
<p>Si queremos crear un índice sobre la propiedad name en orden ascendente haríamos lo siguiente:</p>
<blockquote>
<p>db.students.createIndex( {name:1} )
{
  "createdCollectionAutomatically" : false,
  "numIndexesBefore" : 1,
  "numIndexesAfter" : 2,
  "ok" : 1
}
Si ahora volvemos a ejecutar la consulta por nombre, comprobaremos como ahora ya realiza una búsqueda directa (valor FETCH en winningPlan.stage) y que no ha tenido que recorrer todos los documentos.</p>
<p>db.students.find({"name" : "Kaila Deibler"}).explain("executionStats")
{
  "queryPlanner" : {
    "plannerVersion" : 1,
    ...
    "winningPlan" : {
      "stage" : "FETCH",
      "inputStage" : {
        "stage" : "IXSCAN",
        "keyPattern" : { "name" : 1 },
        "indexName" : "name_1",
        "isMultiKey" : false,
        "isUnique" : false,
        "isSparse" : false,
        "isPartial" : false,
        "indexVersion" : 1,
        "direction" : "forward",
        "indexBounds" : {
          "name" : [
            "[\"Kaila Deibler\", \"Kaila Deibler\"]"
          ]
        }
      }
    },
    "rejectedPlans" : [ ]
  },
  "executionStats" : {
    "executionSuccess" : true,
    "nReturned" : 2,
    "executionTimeMillis" : 2,
    "totalKeysExamined" : 2,
    "totalDocsExamined" : 2,
    "executionStages" : {
      ...
    }
  },
  "serverInfo" : {
    ...
  },
  "ok" : 1
}
Un aspecto a considerar de los índices es que aceleran mucho las búsquedas, pero ralentizan las inserciones/modificaciones y hace que la información ocupe más espacio en disco. Por ello, deberemos considerar añadir índices a las colecciones donde el número de lecturas sea mayor que el de escrituras. Si sucede al revés, el uso de índices puede provocar un deterioro en el rendimiento.
El orden de los índices (1 para ascendente, -1 para descendente) no importa para un índice sencillo, pero si que tendrá un impacto en los índices compuestos cuando se utilizan para ordenar o con una condición de rango.</p>
</blockquote>
<p>Por supuesto, podemos crear índices sobre propiedades que forman parte de un array. Así pues, podemos crear un índice sobre el tipo de calificación que tiene un estudiante mediante:</p>
<blockquote>
<p>db.students.createIndex( {scores.type:1} )
Pero además también podemos crear un índice sobre todas las calificaciones, lo cual indexa cada elemento del array, con lo que podemos buscar por cualquier objeto del array. Este tipo de índices se conocen como multiclave:</p>
<p>db.students.createIndex( {scores:1} )
Toda la información relativa a los índices creados se almacenan en la colección system.indexes, la cual podremos consultar.</p>
</blockquote>
<p>Además, también podemos obtener los índices de una determinada colección mediante el método getIndexes().</p>
<p>Finalmente, para borrar un índice emplearemos el método dropIndex(atributo).</p>
<p>Así pues, tenemos que algunas de las operaciones relacionadas con los índices más importantes son:</p>
<blockquote>
<p>db.system.indexes.find() // muestra los índices existentes
db.students.getIndexes() // muestra los índices de la colección students
db.students.dropIndex( {"name":1} ) // borra el índice que existe sobre la propiedad name
Propiedades
Al crear un índice podemos pasarle algunas opciones como segundo parámetro, como puede ser:</p>
</blockquote>
<p>unique:true: Permite crear índices que sólo permiten valores únicos en una propiedad. No puede haber valores repetidos y una vez creado no permitirá insertar valores duplicados.</p>
<blockquote>
<p>db.students.createIndex( {students_id:1}, {unique:1} )
El índice sobre _id es único aunque al visualizarlo no nos diga que lo sea, ya que no permite que se inserten dos _id iguales.</p>
</blockquote>
<p>Si queremos añadir un índice sobre una propiedad que no aparece en todos los documentos, necesitamos crear un Sparse Index mediante sparse:true, el cual se crea para el conjunto de claves que tienen valores.</p>
<blockquote>
<p>db.students.createIndex( {size:1}, {sparse:1} )
Si hacemos una consulta sobre una propiedad que tiene asociado un Sparse Index, nos van a aparecer menos resultados, ya que sólo mostrará aquellos que tengan valores, y no tendrá en cuenta los documentos que tengan dicho campo sin crear.</p>
</blockquote>
<p>Autoevaluación
Suponemos que tenemos los siguientes documentos en una colección llamada 'people' con los siguientes documentos:</p>
<blockquote>
<p>db.people.find()
{ "_id" : ObjectId("50a464fb0a9dfcc4f19d6271"), "nombre" : "Juan", "cargo" : "Técnico" }
{ "_id" : ObjectId("50a4650c0a9dfcc4f19d6272"), "nombre" : "Pedro", "cargo" : "CEO" }
{ "_id" : ObjectId("50a465280a9dfcc4f19d6273"), "nombre" : "Sandra" }
Y hay un índice definido del siguiente modo:</p>
<p>db.people.createIndex({cargo:1}, {sparse:1})
Si realizamos la siguiente consulta, ¿Qué documentos aparecerán y por qué? [1]</p>
<p>db.people.find({cargo:null})
Ningún documento, ya que la consulta utiliza el índice y no puede haber documentos que no contengan el campo cargo</p>
</blockquote>
<p>Ningún documento, ya que la consulta de cargo:null sólo encuentra documentos que de manera explícita tienen el cargo a nulo, independientemente del índice.</p>
<p>El documento de Sandra, ya que la consulta no utilizará el índice</p>
<p>Todos los documentos de la colección, ya que todos los documentos cumplen cargo:null</p>
<p>El documento de Sandra, ya que el comando createIndex no se ejecutará sobre este documento.</p>
<p>Finalmente, desde la versión 3.2, podemos emplear índices parciales, para indexar aquellos documentos que cumplen un criterio específico. Al indexar un subconjunto de los documentos de una colección, estos índices ocupan menos, y reducen el coste de almacenamiento y rendimiento a la hora de crearlo. Para ello, le pasaremos a la propiedad partialFilterExpression el criterio que debe cumplir el índice parcial.</p>
<p>Por ejemplo, para indexar por tipo de calificación a aquellos estudiantes con una calificación superior a 95 haríamos:</p>
<blockquote>
<p>db.students.createIndex({"scores.type":1}, {partialFilterExpression:{"scores.score":{$gt:95}}} )
Para utilizar este índice, la consulta debe realizarse por el campo del mismo, y cumplir con un subconjunto de la expresión de filtrado. Por ejemplo:</p>
<p>db.students.find({"scores.type":"exam"}) // No emplea el índice, no utiliza el filtro
db.students.find({"scores.type":"exam", "scores.score":{$gt:90}} ) // No emplea el índice, ya que no cumple el filtr
db.students.find({"scores.type":"exam", "scores.score":{$gt:96}} ) // Si emplea el filtro
Más información sobre los índices parciales en https://docs.mongodb.org/manual/core/index-partial/</p>
</blockquote>
<h3 id="compuestos">Compuestos<a class="headerlink" href="#compuestos" title="Permanent link">&para;</a></h3>
<p>Si queremos aplicar un índice sobre más de una propiedad, podemos crear índices compuestos, indicando las propiedades separadas por coma:</p>
<blockquote>
<p>db.students.createIndex({"name":1, "scores.type":1})
Es importante destacar que el orden de los índices importa, y mucho. Si hacemos una consulta que sólo utilice el atributo scores.type, este índice no se va a utilizar.</p>
</blockquote>
<p>No confundir los índices compuestos con hacer 2 o más índices sobre diferentes propiedades.
Si creamos un índice sobre los campos (A,B,C), el índice se va a utilizar para las búsquedas sobre A, sobre la dupla (A,B) y sobre el trio (A,B,C). Es decir, los índices se usan con los subconjuntos por la izquierda (prefijos) de los índices compuestos.</p>
<p>Si tenemos varios índices candidatos a la hora de ejecutar, el optimizador de consultas de MongoDB los usará en paralelo y se quedará con el resultado del primero que termine. Más información en http://docs.mongodb.org/manual/core/query-plans/</p>
<h3 id="multiclave">Multiclave<a class="headerlink" href="#multiclave" title="Permanent link">&para;</a></h3>
<p>Cuando se indexa una propiedad que es un array se crea un índice multiclave para todos los valores del array de todos los documentos. El uso de estos índices son lo que hacen que las consultas sobre documentos embebidos funcionen tan rápido.</p>
<blockquote>
<p>db.students.createIndex({"teachers":1})
db.students.find({"teachers":{"$all":[1,3]}})
Se pueden crear índices tanto en propiedades básicas, como en propiedades internas de un array, mediante la notación de .:</p>
<p>db.students.createIndex({"addresses.phones":1})
Sólo se pueden crear índices compuestos multiclave cuando sólo una de las propiedades del índice compuesto es un array; es decir, no puede haber dos propiedades array en un índice compuesto. Hay que tener cuidado ya que no se va a quejar al crearlo, solo al insertar, porque no va a poder indexar arrays paralelos.</p>
</blockquote>
<h3 id="rendimiento_1">Rendimiento<a class="headerlink" href="#rendimiento_1" title="Permanent link">&para;</a></h3>
<p>Por defecto, los índices se crean en <em>foreground</em>, de modo que al crear un índice se van a bloquear a todos los <em>writers</em>. Si queremos crearlos en <em>background</em> para no penalizar las escrituras (es más lento, de 2 a 5 veces) lo indicaremos con un segundo parámetro:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">createIndex</span><span class="p">({</span><span class="s2">&quot;twitter&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nx">background</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
<span class="linenos" data-linenos=" 2 "></span><span class="sb">````</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="nx">Más</span><span class="w"> </span><span class="nx">información</span><span class="w"> </span><span class="nx">sobre</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">creación</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="o">*</span><span class="nx">background</span><span class="o">*</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">https</span><span class="o">:</span><span class="c1">//docs.mongodb.org/manual/core/index-creation/&gt;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="nx">Algunos</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">operadores</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">utilizan</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">índices</span><span class="w"> </span><span class="nx">eficientemente</span><span class="w"> </span><span class="nx">son</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">operadores</span><span class="w"> </span><span class="sb">`$where`</span><span class="p">,</span><span class="w"> </span><span class="sb">`$nin`</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="sb">`$exists`</span><span class="p">.</span><span class="w"> </span><span class="nx">Cuando</span><span class="w"> </span><span class="nx">estos</span><span class="w"> </span><span class="nx">operadores</span><span class="w"> </span><span class="nx">se</span><span class="w"> </span><span class="nx">emplean</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">una</span><span class="w"> </span><span class="nx">consultar</span><span class="w"> </span><span class="nx">hay</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">tener</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">mente</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">posible</span><span class="w"> </span><span class="nx">cuelo</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">botella</span><span class="w"> </span><span class="nx">cuando</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">tamaño</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">datos</span><span class="w"> </span><span class="nx">incremente</span><span class="p">.</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="nx">Plan</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">ejecución</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nx">Al</span><span class="w"> </span><span class="nx">explicar</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">índices</span><span class="w"> </span><span class="nx">ya</span><span class="w"> </span><span class="nx">hemos</span><span class="w"> </span><span class="nx">visto</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">podemos</span><span class="w"> </span><span class="nx">obtener</span><span class="w"> </span><span class="nx">información</span><span class="w"> </span><span class="nx">sobre</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">operación</span><span class="w"> </span><span class="nx">realizada</span><span class="w"> </span><span class="nx">mediante</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">método</span><span class="w"> </span><span class="p">.</span><span class="nx">explain</span><span class="p">().</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="nx">El</span><span class="w"> </span><span class="nx">atributo</span><span class="w"> </span><span class="nx">indexOnly</span><span class="w"> </span><span class="nx">me</span><span class="w"> </span><span class="nx">dice</span><span class="w"> </span><span class="nx">si</span><span class="w"> </span><span class="nx">toda</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">información</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">quiero</span><span class="w"> </span><span class="nx">recuperar</span><span class="w"> </span><span class="nx">se</span><span class="w"> </span><span class="nx">encuentra</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">índice</span><span class="p">.</span><span class="w"> </span><span class="nx">Este</span><span class="w"> </span><span class="nx">atributo</span><span class="w"> </span><span class="nx">va</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">depender</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">campos</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">quiera</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">me</span><span class="w"> </span><span class="nx">devuelva</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">consulta</span><span class="p">,</span><span class="w"> </span><span class="nx">si</span><span class="w"> </span><span class="nx">son</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">subconjunto</span><span class="w"> </span><span class="nx">del</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">utilizado</span><span class="p">.</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="nx">Más</span><span class="w"> </span><span class="nx">información</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//docs.mongodb.org/manual/reference/method/cursor.explain/</span>
<span class="linenos" data-linenos="14 "></span><span class="nx">Los</span><span class="w"> </span><span class="nx">índices</span><span class="w"> </span><span class="nx">tienen</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">caber</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">memoria</span><span class="p">.</span><span class="w"> </span><span class="nx">Si</span><span class="w"> </span><span class="nx">están</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">disco</span><span class="p">,</span><span class="w"> </span><span class="nx">pese</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">ser</span><span class="w"> </span><span class="nx">algorítmicamente</span><span class="w"> </span><span class="nx">mejores</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">tener</span><span class="p">,</span><span class="w"> </span><span class="nx">al</span><span class="w"> </span><span class="nx">ser</span><span class="w"> </span><span class="nx">más</span><span class="w"> </span><span class="nx">grandes</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">RAM</span><span class="w"> </span><span class="nx">disponible</span><span class="p">,</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">se</span><span class="w"> </span><span class="nx">obtienen</span><span class="w"> </span><span class="nx">beneficios</span><span class="w"> </span><span class="nx">por</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">penalización</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">paginación</span><span class="p">.</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="nx">Para</span><span class="w"> </span><span class="nx">averiguar</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">tamaño</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">índices</span><span class="w"> </span><span class="p">(</span><span class="nx">en</span><span class="w"> </span><span class="nx">bytes</span><span class="p">)</span><span class="o">:</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">stats</span><span class="p">()</span><span class="w">  </span><span class="c1">// obtiene estadísticas de la colección</span>
<span class="linenos" data-linenos="19 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">totalIndexSize</span><span class="p">()</span><span class="w">  </span><span class="c1">// obtiene el tamaño del índice</span>
<span class="linenos" data-linenos="20 "></span><span class="nx">Mucho</span><span class="w"> </span><span class="nx">cuidado</span><span class="w"> </span><span class="nx">con</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">índices</span><span class="w"> </span><span class="nx">multikeys</span><span class="w"> </span><span class="nx">porque</span><span class="w"> </span><span class="nx">crecen</span><span class="w"> </span><span class="nx">mucho</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="nx">si</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">documento</span><span class="w"> </span><span class="nx">tiene</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">moverse</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">disco</span><span class="p">,</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">cambio</span><span class="w"> </span><span class="nx">supone</span><span class="w"> </span><span class="nx">tener</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">cambiar</span><span class="w"> </span><span class="nx">todos</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">puntos</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">del</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span>
<span class="linenos" data-linenos="21 "></span><span class="nx">Aunque</span><span class="w"> </span><span class="nx">sea</span><span class="w"> </span><span class="nx">más</span><span class="w"> </span><span class="nx">responsabilidad</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">DBA</span><span class="p">,</span><span class="w"> </span><span class="nx">los</span><span class="w"> </span><span class="nx">desarrolladores</span><span class="w"> </span><span class="nx">debemos</span><span class="w"> </span><span class="nx">saber</span><span class="w"> </span><span class="nx">si</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">va</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">caber</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">memoria</span><span class="p">.</span><span class="w"> </span><span class="nx">Si</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">van</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">caber</span><span class="w"> </span><span class="nx">es</span><span class="w"> </span><span class="nx">mejor</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">usarlos</span><span class="p">.</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="nx">Si</span><span class="w"> </span><span class="nx">vemos</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">usamos</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">su</span><span class="w"> </span><span class="nx">rendimiento</span><span class="w"> </span><span class="nx">es</span><span class="w"> </span><span class="nx">peor</span><span class="p">,</span><span class="w"> </span><span class="nx">podemos</span><span class="w"> </span><span class="nx">borrarlos</span><span class="w"> </span><span class="nx">con</span><span class="w"> </span><span class="nx">dropIndex</span><span class="p">.</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="o">&gt;</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">dropIndex</span><span class="p">(</span><span class="s1">&#39;nombreDeíndice&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="26 "></span><span class="nx">Podemos</span><span class="w"> </span><span class="nx">obtener</span><span class="w"> </span><span class="nx">más</span><span class="w"> </span><span class="nx">información</span><span class="w"> </span><span class="nx">sobre</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">rendimiento</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">las</span><span class="w"> </span><span class="nx">consultas</span><span class="w"> </span><span class="nx">mediante</span><span class="w"> </span><span class="nx">su</span><span class="w"> </span><span class="nx">plan</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">ejecución</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">https</span><span class="o">:</span><span class="c1">//docs.mongodb.org/manual/tutorial/analyze-query-plan/</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="nx">Autoevaluación</span>
<span class="linenos" data-linenos="29 "></span><span class="nx">Hemos</span><span class="w"> </span><span class="nx">actualizado</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">documento</span><span class="w"> </span><span class="nx">con</span><span class="w"> </span><span class="nx">una</span><span class="w"> </span><span class="nx">clave</span><span class="w"> </span><span class="nx">llamada</span><span class="w"> </span><span class="nx">etiquetas</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">provoca</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">documento</span><span class="w"> </span><span class="nx">tenga</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">moverse</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">disco</span><span class="p">.</span><span class="w"> </span><span class="nx">Supongamos</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">documento</span><span class="w"> </span><span class="nx">contiene</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="nx">etiquetas</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">él</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">etiquetas</span><span class="w"> </span><span class="nx">está</span><span class="w"> </span><span class="nx">indexada</span><span class="w"> </span><span class="nx">con</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">multiclave</span><span class="p">.</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="err">¿</span><span class="nx">Cuantos</span><span class="w"> </span><span class="nx">puntos</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">tienen</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">actualizarse</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">para</span><span class="w"> </span><span class="nx">acodomar</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">movimiento</span><span class="o">?</span><span class="w"> </span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span><span class="o">!!!</span><span class="w"> </span><span class="nx">tip</span><span class="w"> </span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="nx">Si</span><span class="w"> </span><span class="nx">en</span><span class="w"> </span><span class="nx">algún</span><span class="w"> </span><span class="nx">momento</span><span class="w"> </span><span class="nx">queremos</span><span class="w"> </span><span class="nx">forzar</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">uso</span><span class="w"> </span><span class="nx">de</span><span class="w"> </span><span class="nx">un</span><span class="w"> </span><span class="nx">determinado</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">al</span><span class="w"> </span><span class="nx">realizar</span><span class="w"> </span><span class="nx">una</span><span class="w"> </span><span class="nx">consulta</span><span class="p">,</span><span class="w"> </span><span class="nx">necesitaremos</span><span class="w"> </span><span class="nx">usar</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">método</span><span class="w"> </span><span class="p">.</span><span class="nx">hint</span><span class="p">({</span><span class="nx">campo</span><span class="o">:</span><span class="mf">1</span><span class="p">})</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="nx">Si</span><span class="w"> </span><span class="nx">queremos</span><span class="w"> </span><span class="nx">que</span><span class="w"> </span><span class="nx">se</span><span class="w"> </span><span class="nx">utilice</span><span class="w"> </span><span class="nx">el</span><span class="w"> </span><span class="nx">índice</span><span class="w"> </span><span class="nx">asociado</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">la</span><span class="w"> </span><span class="nx">propiedad</span><span class="w"> </span><span class="nx">twitter</span><span class="o">:</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span><span class="sb">``` js</span>
<span class="linenos" data-linenos="39 "></span><span class="sb">&gt; db.people.find({nombre:&quot;Aitor Medrano&quot;,twitter:&quot;aitormedrano&quot;}).hint({twitter:1}})</span>
</code></pre></div>
<p>Si por algún motivo no queremos usar índices, le pasaremos el operador $natural al método hint().</p>
<blockquote>
<p>db.people.find({nombre:"Aitor Medrano",twitter:"aitormedrano"}).hint({$natural:1}})
Si usamos un hint sobre un índice sparse y no hay documentos a devolver con dicho índice porque todos sus campos son nulos, la consulta no devolverá nada, aunque haya documentos que sin dicho índice si cumplen los criterios.</p>
</blockquote>
<p>Hay que destacar que los operadores $gt, $lt, $ne … provocan un uso ineficiente de los índices, ya que la consulta tiene que recorrer toda la colección de índices. Si hacemos una consulta sobre varios atributos y en uno de ellos usamos $gt, $lt o similar, es mejor hacer un hint sobre el resto de atributos que sí tienen una selección directa.</p>
<p>Por ejemplo, supongamos que en la coleccion de calificaciones quieseramos obtener los exámenes con un calificación comprendida entre 95 y 98.</p>
<blockquote>
<p>db.grades.find({ score:{$gt:95, $lte:98}, type:"exam" })
Para esta consulta, suponiendo que tenemos un índice tanto en score como en type, sería conveniente hacer el hint sobre el type</p>
<p>db.grades.find({ score:{$gt:95, $lte:98}, type:"exam" }).hint('type')
Otros tipos de índices
Geoespaciales, para trabajar con coordenadas → http://docs.mongodb.org/manual/applications/geospatial-indexes/</p>
</blockquote>
<p>De texto, para realizar búsquedas dentro de un campo → http://docs.mongodb.org/manual/core/index-text/</p>
<p>Hash, centrado en el uso de sharding → http://docs.mongodb.org/manual/core/index-hashed/</p>
<h2 id="colecciones-limitadas">Colecciones limitadas<a class="headerlink" href="#colecciones-limitadas" title="Permanent link">&para;</a></h2>
<p>Una colección limitada (<em>capped collection</em>) es una colección de tamaño fijo, donde se garantiza el orden natural de los datos, es decir, el orden en que se insertaron.</p>
<p>Una vez se llena la colección, se eliminan los datos más antiguos, y los datos más nuevos se añaden al final, de manera similar a un buffer circular, asegurando que el orden natural de la colección sigue el orden en el que se insertaron los registros.</p>
<p>Este tipo de colecciones se utilizan para logs y auto-guardado de información, ya que su rendimiento es muy alto para inserciones.</p>
<p>Se crean de manera explícita mediante el método createCollection, pasándole el tamaño en bytes de la colección. Por ejemplo, si queremos cerar una colección para auditar datos de 20 KB haríamos:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s2">&quot;auditoria&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capped</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">:</span><span class="mf">20480</span><span class="p">})</span>
</code></pre></div>
Los documentos que se añaden a una colección limitada se pueden modifican, pero no pueden crecer en tamaño. Si sucede, la modificación fallará. Además, tampoco se pueden eliminar documentos de la colección. Para ello, hay que borrar toda la colección (drop) y volver a crearla.
También podemos limitar el número de elementos que se pueden añadir a la colección mediante el parámetro max: en la creación de la colección. Sin embargo, hay que asegurarse de disponer de suficiente espacio en la colección para los elementos que queremos añadir. Si la colección se llena antes de que el número de elementos se alcance, se eliminará el elemento más antiguo de la colección.</p>
<p>Si retomamos el ejemplo anterior, pero fijamos su máximo a 100 elementos, crearíamos la colección del siguiente modo:</p>
<p>Creando una colección limitada a 100 documentos</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s2">&quot;auditoria&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capped</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">:</span><span class="mf">20480</span><span class="p">,</span><span class="w"> </span><span class="nx">max</span><span class="o">:</span><span class="mf">100</span><span class="p">})</span>
</code></pre></div>
<p>El shell de MongoDB ofrece la utilidad validate() para visualizar la cantidad de espacio utilizado por cada colección, ya sea limitada o no. Para comprobar el estado de la colección anterior haríamos:</p>
<p>Validando el estado de una colección</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">auditoria</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
</code></pre></div>
<p>Si queremos consultar los datos de una colección limitada, por su idiosincracia, los resultados aparecerán en el orden de inserción. Si queremos obtenerlos en orden inverso, le tenemos que pasar el operador $natural al método sort():</p>
<p>Consultando una colección limitada a la inversa</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">auditoria</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">sort</span><span class="p">({</span><span class="w"> </span><span class="nx">$natural</span><span class="o">:-</span><span class="mf">1</span><span class="w"> </span><span class="p">})</span>
</code></pre></div>
<p>Finalmente, si queremos averiguar si una colección es limitada, lo haremos mediante el método <code>isCapped()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">auditoria</span><span class="p">.</span><span class="nx">isCapped</span><span class="p">()</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// true</span>
</code></pre></div>
<p>Más información en <a href="https://docs.mongodb.org/manual/core/capped-collections/">https://docs.mongodb.org/manual/core/capped-collections/</a></p>
<h2 id="profiling">Profiling<a class="headerlink" href="#profiling" title="Permanent link">&para;</a></h2>
<p>Si arrancamos el demonio con la opción --rest lanzará un servidor HTTP que escucha peticiones en el puerto 28017. Este servidor captura peticiones REST que permiten realizar consultas sobre la información administrativa de la base de datos.</p>
<p>Así pues, si abrimos el navegador y accedemos a http://localhost:28017 obtendremos algo similar a esto:</p>
<p>Interfaz REST de mongod
Figure 4. Interfaz REST de mongod
Más información en http://docs.mongodb.org/ecosystem/tools/http-interfaces</p>
<p>Además, MongoDB trae integradas varias herramientas para el control del rendimiento.</p>
<p>Por ejemplo, la colección db.system.profile auditará las consultas ejecutadas. Podemos indicar el nivel de las consultas a auditar mediante tres niveles: 0 (ninguna), 1 (consultas lentas), 2 (todas las consultas)</p>
<p>Si queremos que se auditen todas las consultas, lo indicaremos del siguiente modo:</p>
<p>Auditando todas las consultas</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">setProfilingLevel</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span>
</code></pre></div>
<p>El método setProfilingLevel() también admite un segundo parámetro para indicar el numero mínimo de milisegundos de las consultas para ser auditadas.</p>
<p>Por defecto, MongoDB automáticamente escribe en el log las consultas que tardan más de 100ms.
Si queremos indicar estas propiedades al arrancar el demonio, le pasaremos los parámetros <code>--profile</code> y/o <code>--slowms</code>:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">mongod</span><span class="w"> </span><span class="o">--</span><span class="nx">profile</span><span class="o">=</span><span class="mf">1</span><span class="w"> </span><span class="o">--</span><span class="nx">slowms</span><span class="o">=</span><span class="mf">15</span>
</code></pre></div>
Si en algún momento queremos consultar tanto el nivel como el estado del profiling, podemos utilizar los métodos <code>db.getProfilingLevel()</code> y <code>db.getProfilingStatus()</code>.</p>
<p>Sobre los datos auditados, podemos hacer find sobre <code>db.system.profile</code> y filtrar por los campos mostrados:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">system</span><span class="p">.</span><span class="nx">profile</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="w"> </span><span class="nx">millis</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$gt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1000</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}).</span><span class="nx">sort</span><span class="p">({</span><span class="nx">ts</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">})</span>
<span class="linenos" data-linenos="2 "></span><span class="nx">db</span><span class="p">.</span><span class="nx">system</span><span class="p">.</span><span class="nx">profile</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">limit</span><span class="p">(</span><span class="mf">10</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ts</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">).</span><span class="nx">pretty</span><span class="p">()</span>
</code></pre></div>
<p>Dentro de estas consultas algunos campos significativos son:</p>
<ul>
<li><code>op</code>: tipo de operación, ya sea <code>command</code>, <code>query</code>, <code>insert</code>, …</li>
<li><code>millis</code>: tiempo empleado en la operación</li>
<li><code>ts</code>: <em>timestamp</em> de la operación</li>
</ul>
<p>Podéis consultar todos los campos disponibles en http://docs.mongodb.org/manual/reference/database-profiler/</p>
<p>Otras herramientas para controlar el rendimiento que se ejecutan en un terminal, son:</p>
<ul>
<li><code>mongotop</code> → similar a la herramienta top de UNIX, muestra el tiempo empleado por MongoDB en las diferentes colecciones, indicando tanto el tiempo empleado en lectura como en escrituras. Para ello, si queremos se ejecute cada tres segundos, en un terminal:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>mongotop<span class="w"> </span><span class="m">3</span>
</code></pre></div>
<p>Ejemplo de ejecutar mongotop 3
Figure 5. Ejemplo de mongotop</p>
<p>Más información en : http://docs.mongodb.org/manual/reference/program/mongotop/
* <code>mongostat</code> → muestra el número de operaciones por cada tipo que se realizan por segundo a nivel de servidor, lo que nos da una instantánea de los que está haciendo el servidor.</p>
<p>Ejemplo de ejecutar mongostat 5
Figure 6. Ejemplo de mongostat
Una buena columna a vigilar es idx miss %, la cual muestra los índices perdidos, es decir, aquellas consultas que han causado paginación y en vez de obtener los datos de memoria han tenido que acceder a disco.</p>
<p>Más información en : http://docs.mongodb.org/manual/reference/program/mongostat/</p>
<h2 id="referencias">Referencias<a class="headerlink" href="#referencias" title="Permanent link">&para;</a></h2>
<h2 id="actividades">Actividades<a class="headerlink" href="#actividades" title="Permanent link">&para;</a></h2>
<p>https://www.adrformacion.com/cursos/mongodb2/mongodb2.html</p>
<p>https://www.adrformacion.com/knowledge/programacion/el_uso_de_indices_con_mongodb.html</p>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        <a href='https://ko-fi.com/T6T8GWT9N' title='Invítame a un café en ko-fi.com' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Invítame a un café en ko-fi.com' /></a>
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="Me encantan estos apuntes" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Los apuntes son mejorables" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Gracias por tu tiempo. Si quieres me puedes <a href='https://ko-fi.com/T6T8GWT9N'>invitar a un café en ko-fi</a>.
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              ¡Gracias por tu colaboración! Ayúdame a mejorar los apuntes enviándome un mail a <a href="mailto:a.medrano@edu.gva.es">a.medrano@edu.gva.es</a> con tus comentarios.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2022-2023 Aitor Medrano - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Consentimiento de cookie</h4>
<p>Esta página de apuntes utiliza cookies para reconocer las visitas, medir la efectividad de la documentación y averiguar si encuentras aquello que buscas o cómo has llegado a estos apuntes. Con tu consentimiento, me ayudas a mejorar estos materiales.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Aceptar</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestionar cookies</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "content.code.annotate", "announce.dismiss", "toc.follow", "content.code.copy"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
    
  </body>
</html>