
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Repaso a los sistemas de almacenamiento ofrece AWS, centrándonos tanto en EBS como en los diferentes tipos de S3 y EFS.">
      
      
      
        <link rel="canonical" href="https://aitor-medrano.github.io/iabd2223/cloud/03s3.html">
      
      
        <link rel="prev" href="02aws.html">
      
      
        <link rel="next" href="04computacion.html">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.1">
    
    
      
        <title>Almacenamiento en la nube AWS. EBS, S3 y EFS. - IABD</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-MFP4QLMMV7"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-MFP4QLMMV7",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-MFP4QLMMV7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Almacenamiento en la nube AWS. EBS, S3 y EFS. - IABD" >
      
        <meta  property="og:description"  content="Repaso a los sistemas de almacenamiento ofrece AWS, centrándonos tanto en EBS como en los diferentes tipos de S3 y EFS." >
      
        <meta  property="og:image"  content="https://aitor-medrano.github.io/iabd2223/assets/images/social/cloud/03s3.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://aitor-medrano.github.io/iabd2223/cloud/03s3.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Almacenamiento en la nube AWS. EBS, S3 y EFS. - IABD" >
      
        <meta  name="twitter:description"  content="Repaso a los sistemas de almacenamiento ofrece AWS, centrándonos tanto en EBS como en los diferentes tipos de S3 y EFS." >
      
        <meta  name="twitter:image"  content="https://aitor-medrano.github.io/iabd2223/assets/images/social/cloud/03s3.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#almacenamiento-en-la-nube" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="IABD" class="md-header__button md-logo" aria-label="IABD" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IABD
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Almacenamiento en la nube AWS. EBS, S3 y EFS.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="IABD" class="md-nav__button md-logo" aria-label="IABD" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    IABD
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../sa/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Sistemas de almacenamiento
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Sistemas de almacenamiento
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/01nosql.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Almacenamiento de datos. NoSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/02mongo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/03modelado.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelado de datos NoSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/05agregaciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agregaciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/06replicacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Replicación y Particionado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/07pymongo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB y Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../hadoop/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Ecosistema Hadoop
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Ecosistema Hadoop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/01arq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arquitecturas Big Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/02etl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingesta de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/03hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hadoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/04hdfs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/04formatos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formatos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/05flume.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sqoop y Flume
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hadoop/06hive.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hive
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Datos en el cloud
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Datos en el cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="01cloud.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="02aws.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    S3
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03s3.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    S3
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#amazon-ebs" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon EBS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon EBS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#volumenes" class="md-nav__link">
    <span class="md-ellipsis">
      Volúmenes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instantaneas" class="md-nav__link">
    <span class="md-ellipsis">
      Instantáneas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-efs" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon EFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-s3" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon S3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon S3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elementos-de-un-objeto" class="md-nav__link">
    <span class="md-ellipsis">
      Elementos de un objeto
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clases-de-almacenamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Clases de almacenamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buckets" class="md-nav__link">
    <span class="md-ellipsis">
      Buckets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#casos-de-uso" class="md-nav__link">
    <span class="md-ellipsis">
      Casos de uso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#costes" class="md-nav__link">
    <span class="md-ellipsis">
      Costes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sitio-web-estatico" class="md-nav__link">
    <span class="md-ellipsis">
      Sitio web estático
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-select" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceso" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seguridad" class="md-nav__link">
    <span class="md-ellipsis">
      Seguridad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#s3-y-python" class="md-nav__link">
    <span class="md-ellipsis">
      S3 y Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="S3 y Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caso-de-uso-1-comunicacion-con-s3" class="md-nav__link">
    <span class="md-ellipsis">
      Caso de uso 1 - Comunicación con S3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caso-de-uso-2-s3select-desde-python" class="md-nav__link">
    <span class="md-ellipsis">
      Caso de uso 2 - S3Select desde Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="04computacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EC2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="05emr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="06datos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDS y DynamoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="07athena.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Athena
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../spark/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Spark
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Spark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/01spark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ecosistema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/01rdd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02dataframeAPI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrames API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02agregaciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agregaciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/02catalog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark JDBC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/03streaming.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/03join-window.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming II
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../dataflow/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Flujo de datos
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Flujo de datos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/04nifi1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nifi I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/05nifi2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nifi II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/02kafka.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/03kafka.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/06airflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://aitor-medrano.github.io/pia2223/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIA FP
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#amazon-ebs" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon EBS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon EBS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#volumenes" class="md-nav__link">
    <span class="md-ellipsis">
      Volúmenes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instantaneas" class="md-nav__link">
    <span class="md-ellipsis">
      Instantáneas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-efs" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon EFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-s3" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon S3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon S3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elementos-de-un-objeto" class="md-nav__link">
    <span class="md-ellipsis">
      Elementos de un objeto
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clases-de-almacenamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Clases de almacenamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buckets" class="md-nav__link">
    <span class="md-ellipsis">
      Buckets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#casos-de-uso" class="md-nav__link">
    <span class="md-ellipsis">
      Casos de uso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#costes" class="md-nav__link">
    <span class="md-ellipsis">
      Costes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sitio-web-estatico" class="md-nav__link">
    <span class="md-ellipsis">
      Sitio web estático
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-select" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceso" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seguridad" class="md-nav__link">
    <span class="md-ellipsis">
      Seguridad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#s3-y-python" class="md-nav__link">
    <span class="md-ellipsis">
      S3 y Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="S3 y Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caso-de-uso-1-comunicacion-con-s3" class="md-nav__link">
    <span class="md-ellipsis">
      Caso de uso 1 - Comunicación con S3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caso-de-uso-2-s3select-desde-python" class="md-nav__link">
    <span class="md-ellipsis">
      Caso de uso 2 - S3Select desde Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="almacenamiento-en-la-nube">Almacenamiento en la nube<a class="headerlink" href="#almacenamiento-en-la-nube" title="Permanent link">&para;</a></h1>
<p>El almacenamiento en la nube, por lo general, es más confiable, escalable y seguro que los sistemas de almacenamiento tradicionales en las instalaciones.</p>
<p>El análisis de <em>Big Data</em>, el almacenamiento de datos, el Internet de las cosas (IoT), las bases de datos y las aplicaciones de copias de seguridad y archivo dependen de algún tipo de arquitectura de almacenamiento de datos.</p>
<p>El almacenamiento más básico es el que incluyen las propias instancias, también conocido como el <strong>almacén de instancias</strong>, o almacenamiento efímero, es un almacenamiento temporal que se agrega a la instancia de EC2.</p>
<p>El almacén de instancias es una buena opción para el almacenamiento temporal de información que cambia con frecuencia, como <em>buffers</em>, memorias caché, datos de pruebas y demás contenido temporal. También se puede utilizar para los datos que se replican en una flota de instancias, como un grupo de servidores web con balanceo de carga. Si las instancias se detienen, ya sea debido a un error del usuario o un problema de funcionamiento, se eliminarán los datos en el almacén de instancias.</p>
<div class="admonition info">
<p class="admonition-title">Almacenamiento de bloque o de objeto</p>
<p>AWS permite almacenar los datos en bloques o como objetos. Si el almacenamiento es en bloques, los datos se almacenan por trozos (bloques), de manera si se modifica una parte de los datos, solo se ha de modificar el bloque que lo contiene. En cambio, si el almacenamiento es a nivel de objeto, una modificación implica tener que volver a actualizar el objeto entero.<br />
Esto provoca que el almacenamiento por bloque sea más rápido. En cambio, el almacenamiento de objetos es más sencillo y por tanto más barato.</p>
</div>
<p>AWS ofrece múltiples soluciones que vamos a revisar:</p>
<figure style="align: center;">
    <img src="images/02s3-ebs-efs.png" width="500">
    <figcaption>Servicios de almacenamiento de AWS</figcaption>
</figure>

<h2 id="amazon-ebs">Amazon EBS<a class="headerlink" href="#amazon-ebs" title="Permanent link">&para;</a></h2>
<p><em>Amazon Elastic Block Store</em> (<a href="https://aws.amazon.com/es/ebs/">https://aws.amazon.com/es/ebs/</a>) ofrece volúmenes de almacenamiento a nivel de bloque de alto rendimiento para utilizarlos con instancias de Amazon EC2 para las cargas de trabajo con un uso intensivo de transacciones y de rendimiento.</p>
<p>Los beneficios adicionales incluyen la replicación en la misma zona de disponibilidad, el cifrado fácil y transparente, los volúmenes elásticos y las copias de seguridad mediante instantáneas.</p>
<div class="admonition tip">
<p class="admonition-title">Importante</p>
<p>AmazonEBS se puede montar en una instancia de EC2 solamente dentro de la misma zona de disponibilidad.</p>
</div>
<h3 id="volumenes">Volúmenes<a class="headerlink" href="#volumenes" title="Permanent link">&para;</a></h3>
<div class="admonition info inline end">
<p class="admonition-title">IOPS</p>
<p>El término IOPS, <em>operaciones de entrada y salida por segundo</em>, representa una medida de rendimiento frecuente que se utiliza para comparar dispositivos de almacenamiento.
Un artículo muy interesante es <a href="https://cloudcasts.io/article/what-you-need-to-know-about-iops">What you need to know about IOPS</a>.</p>
</div>
<p>Los volúmenes de EBS proporcionan almacenamiento externo a EC2 que persiste independientemente de la vida de la instancia. Son similares a discos virtuales en la nube. <em>AmazonEBS</em> ofrece tres tipos de volúmenes: SSD de uso general, SSD de IOPS provisionadas y magnéticos (HDD). Los tres tipos de volúmenes difieren en características de rendimiento y coste, para ofrecer diferentes posibilidades según las necesidades de las aplicaciones:</p>
<ul>
<li><em>Unidades de estado sólido (SSD)</em>: optimizadas para cargas de trabajo de transacciones que implican operaciones de lectura/escritura frecuentes de pequeño tamaño de E/S. Proporciona un equilibrio entre precio y rendimiento, y es el tipo recomendado para la mayoría de las cargas de trabajo. Los tipos existentes son <code>gp3</code> (1.000 MiB/s) y <code>gp2</code>(128-250 MiB/s) ambas con un máximo de 16.000 IOPS.</li>
<li><em>SSD de IOPS provisionadas</em>: proporciona un rendimiento elevado con cargas de trabajo críticas, baja latencia o alto rendimiento. Los tipos existentes con <code>io2 Block Express</code> (4.000 MiB/s con un máximo 246.000 IOPS) e <code>io2</code> (1.000 MiB/s con 64.000 IOPS)</li>
<li><em>Unidades de disco duro (HDD)</em>: optimizadas para grandes cargas de trabajo de streaming. Los tipos existentes con <code>st1</code> (500 MiB/s con 500 IOPS) y <code>sc1</code> (250 MiB/s con 250 IOPS).</li>
</ul>
<p>Más información sobre los diferentes volúmenes: <a href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/UserGuide/ebs-volume-types.html">https://docs.aws.amazon.com/es_es/AWSEC2/latest/UserGuide/ebs-volume-types.html</a></p>
<p>Para crear o configurar un volumen, dentro de las instancias EC2, en el menú lateral podemos ver las opciones de <em>Elastic Block Store</em> y el submenú <em>Volúmenes</em>:</p>
<figure style="align: center;">
    <img src="images/03volumen.png">
    <figcaption>Volúmenes en EBS</figcaption>
</figure>

<p>Los volúmenes de Amazon EBS están asociados a la red, y su duración es independiente a la vida de una instancia. Al tener un alto nivel de disponibilidad y de confianza, pueden aprovecharse como particiones de arranque de instancias de EC2 o asociarse a una instancia de EC2 en ejecución como dispositivos de bloques estándar.</p>
<p>Cuando se utilizan como particiones de arranque, las instancias de Amazon EC2 pueden detenerse y, posteriormente, reiniciarse, lo que le permite pagar solo por los recursos de almacenamiento utilizados al mismo tiempo que conserva el estado de la instancia. Los volúmenes de Amazon EBS tienen mayor durabilidad que los almacenes de instancias de EC2 locales porque los volúmenes de Amazon EBS se <strong>replican automáticamente</strong> en el <em>backend</em> (en una única zona de disponibilidad).</p>
<p>Los volúmenes de Amazon EBS ofrecen las siguientes características:</p>
<ul>
<li>Almacenamiento persistente: el tiempo de vida de los volúmenes es independiente de cualquier instancia de Amazon EC2.</li>
<li>De uso general: son dispositivos de bloques sin formato que se pueden utilizar en cualquier sistema operativo.</li>
<li>Alto rendimiento: ofrecen al menos el mismo o más rendimiento que las unidades de Amazon EC2 locales.</li>
<li>Nivel de fiabilidad alto: tienen redundancia integrada dentro de una zona de disponibilidad.</li>
<li>Diseñados para ofrecer resiliencia: la AFR (tasa anual de errores) de Amazon EBS oscila entre 0,1 % y 1 %.</li>
<li>Tamaño variable: los tamaños de los volúmenes varían entre 1 GB y 16 TB.</li>
<li>Fáciles de usar: se pueden crear, asociar, almacenar en copias de seguridad, restaurar y eliminar fácilmente.</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Un volumen en una instancia</p>
<p>Sólo una instancia de Amazon EC2 a la vez puede montarse en un volumen de Amazon EBS.</p>
</div>
<h3 id="instantaneas">Instantáneas<a class="headerlink" href="#instantaneas" title="Permanent link">&para;</a></h3>
<p>Sin embargo, para los que quieran aún más durabilidad, con <em>Amazon EBS</em> es posible crear instantáneas uniformes puntuales de los volúmenes, que luego se almacenan en <em>Amazon S3</em> y se replican automáticamente en varias zonas de disponibilidad.</p>
<p>Estas instantáneas se pueden utilizar como punto de partida para nuevos volúmenes de Amazon EBS (clonando o restaurando copias de seguridad) y permiten proteger la durabilidad de los datos a largo plazo. Como todo recurso S3, también se pueden compartir fácilmente con compañeros del equipo de desarrollo y otros desarrolladores de AWS.</p>
<h2 id="amazon-efs">Amazon EFS<a class="headerlink" href="#amazon-efs" title="Permanent link">&para;</a></h2>
<p><em>Amazon Elastic File System</em> (<a href="https://aws.amazon.com/es/efs/">https://aws.amazon.com/es/efs/</a>) ofrece almacenamiento para las instancias EC2 a las que pueden acceder <ins>varias máquinas virtuales de forma simultánea</ins>, de manera similar a un NAS (<em>Network Area Storage</em>). Se ha implementado como un sistema de archivos de uso compartido que utiliza el protocolo de sistemas de archivos de red (NFS), al que acceden varios miles de instancia EC2 así como servidores <em>on-premise</em> a traves de una VPN o conexiones directas (<em>AWS Direct Connect</em>).</p>
<p>Se trata de un almacenamiento de archivos simple, escalable y elástico para utilizarlo con los servicios de AWS y los recursos disponibles en las instalaciones. Mediante una interfaz sencilla permite crear y configurar sistemas de archivos de forma rápida y simple.</p>
<p>EFS está diseñado para escalar a petabytes de manera dinámica bajo demanda sin interrumpir las aplicaciones, por lo que se ampliará y reducirá de forma automática a medida que agregue o elimine archivos, no necesitando asignar espacio inicial. Respecto al rendimiento, su IOPS escala de forma automática conforme crece el tamaño del sistema de archivos, ofreciendo dos modos, el de uso general (ofrece alrededor de 7000 operaciones por segundo y fichero) y el max I/O (para miles de instancias que acceden al mismo archivo de forma simultanea), pudiendo admitir un rendimiento superior a 10 GB/seg y hasta 500.000 IOPS.</p>
<p>Las instancias se conectan a EFS desde cualquier AZ de la región. Todas las lecturas y escrituras son consistentes en todas las AZ. Por ejemplo, una lectura en una AZ garantiza que tendrá la misma información, aunque los datos se hayan escrito en otra AZ.</p>
<figure style="align: center;">
    <img src="images/03efs.png">
    <figcaption>EFS compartido entre instancias</figcaption>
</figure>

<p>Respecto al coste (<a href="https://aws.amazon.com/es/efs/pricing/">https://aws.amazon.com/es/efs/pricing/</a>), dependiendo del tipo de acceso y la administración del ciclo de vida, el acceso estándar se factura desde 0,30$ Gb/mes, mientras que si el acceso es poco frecuente, baja a 0,013$ Gb/mes más 0,01$ por transferencia y Gb/mes.</p>
<p>Su casos de uso más comunes son para <em>Big Data</em> y análisis, flujos de trabajo de procesamiento multimedia, administración de contenido, servidores web y directorios principales.</p>
<p>Respecto a su acceso, de manera similar al resto de servicios de almacenamiento, es un servicio completamente administrado al que se puede acceder desde la consola, una API o la CLI de AWS.</p>
<h2 id="amazon-s3">Amazon S3<a class="headerlink" href="#amazon-s3" title="Permanent link">&para;</a></h2>
<p><em>S3</em> (<a href="https://aws.amazon.com/es/s3/">https://aws.amazon.com/es/s3/</a>) es un servicio de almacenamiento persistente de objetos creado para almacenar y recuperar cualquier cantidad de datos desde cualquier lugar mediante una URL: sitios web y aplicaciones móviles, aplicaciones corporativas y datos de sensores o dispositivos de Internet de las cosas (IoT) y análisis de <em>Big Data</em>.</p>
<p>S3 es un servicio de <strong>almacenamiento a nivel de objetos</strong>, y tal como habíamos comentado, significa que además de que los datos contengan metadatos que ayudan a catalogar el objeto, si desea cambiar una parte de un archivo, tiene que realizar la modificación y luego volver a cargar todo el archivo modificado. Esto puede tener implicaciones de rendimiento y consistencia, que conviene tener en cuenta.</p>
<p>Los datos se almacenan como objetos dentro de recursos conocidos como <strong>buckets</strong>. Los objetos pueden ser prácticamente cualquier archivo de datos, como imágenes, videos o registros del servidor. </p>
<p>Es una solución administrada de almacenamiento en la nube que se diseñó para brindar un escalado sin problemas, ofreciendo 99,99% de <strong>disponibilidad</strong> (4 nueves) y 99,999999999% (11 nueves) de <strong>durabilidad</strong>. Además de poder almacenar prácticamente todos los objetos que deseemos dentro de un bucket (los objetos pueden ser de hasta 5TB), S3 permite realizar operaciones de escritura, lectura y eliminación de los objetos almacenados en el bucket. Los nombres de los buckets son universales y deben ser <ins>únicos</ins> entre todos los nombres de buckets existentes en Amazon S3.</p>
<p>De forma predeterminada, en Amazon S3 los datos se almacenan de forma redundante en varias instalaciones y en diferentes dispositivos de cada instalación.</p>
<figure style="align: center;">
    <img src="images/03s3replicacion.png" width="500">
    <figcaption>Replicación en S3</figcaption>
</figure>

<p>Los datos que almacenamos en <em>S3</em> no están asociados a ningún servidor en particular (aunque los <em>buckets</em> se asocien a regiones, los archivos se dice que están almacenados de forma global), con lo que no necesitamos administrar ningún tipo de servidor.</p>
<figure style="float: right;">
    <img src="images/03s3versioning.png" width="100">
    <figcaption>Replicación en S3</figcaption>
</figure>

<p>Amazon S3 contiene billones de objetos y, con regularidad, tiene picos de millones de solicitudes por segundo, por ende, es un servicio de alto rendimiento, con una latencia de primer byte que se mide en milisegundos para la mayoría de las clases de almacenamiento.</p>
<h3 id="elementos-de-un-objeto">Elementos de un objeto<a class="headerlink" href="#elementos-de-un-objeto" title="Permanent link">&para;</a></h3>
<p>Cada objeto que almacenamos en S3 tiene:</p>
<ul>
<li>una clave: nombre que se le asigna al objeto y que se utiliza para recuperarlo.</li>
<li>un id de versión: podemos mantener un histórico de cambios mediante el <em>versionado de los archivos</em>, de manera que cuando actualicemos un objeto, en vez de sustituirlo, se crea una nuevo versión manteniendo un histórico. Más información en <a href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/versioning-workflows.html">https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/versioning-workflows.html</a></li>
<li>un valor: contenido real que se almacena.</li>
<li>metadatos: pares clave-valor, que podemos definir nosotros como usuarios.</li>
<li>subrecursos: que utiliza AWS para almacenar información adicional.</li>
</ul>
<h3 id="clases-de-almacenamiento">Clases de almacenamiento<a class="headerlink" href="#clases-de-almacenamiento" title="Permanent link">&para;</a></h3>
<p>S3 ofrece una variedad de clases de almacenamiento (<a href="https://docs.aws.amazon.com/es_es/S3/latest/userguide/storage-class-intro.html">https://docs.aws.amazon.com/es_es/S3/latest/userguide/storage-class-intro.html</a>) a nivel de objetos que están diseñadas para diferentes casos de uso. Entre estas clases se incluyen las siguientes:</p>
<ul>
<li><strong>S3 Estándar</strong>: diseñada para ofrecer almacenamiento de objetos de alta durabilidad, disponibilidad y rendimiento para los datos a los que se accede con frecuencia. Como ofrece baja latencia y alto nivel de rendimiento, es una opción adecuada para aplicaciones en la nube, sitios web dinámicos, distribución de contenido, aplicaciones para dispositivos móviles y videojuegos, y el análisis de <em>big data</em>.</li>
<li><strong>S3 Estándar - Acceso poco frecuente</strong>: se utiliza para los datos a los que se accede con menos frecuencia, pero que requieren acceso rápido cuando es necesario. Es una opción ideal para el almacenamiento y las copias de seguridad a largo plazo, además de almacén de datos para los archivos de recuperación de desastres.</li>
<li><strong>S3 Única zona – Acceso poco frecuente</strong>: diseñada para guardar los datos a los que se accede con menos frecuencia, pero que requieren acceso rápido cuando es necesario, pero sin tener replicas (la clase S3 estándar replica los datos en un mínimo de tres AZ). Es una buena opción para almacenar copias de seguridad secundarias de los datos que se encuentran en las instalaciones o de los datos que se pueden volver a crear fácilmente.</li>
<li><strong>S3 Intelligent-Tiering</strong>: diseñada para optimizar los costes mediante la migración automática de los datos entre capas, sin que se perjudique el rendimiento ni se produzca una sobrecarga operativa. Se encarga de monitorizar los patrones de acceso de los objetos y traslada aquellos a los que no se ha accedido durante 30 días consecutivos a la capa de acceso poco frecuente. Si se accede a un objeto en la capa de acceso poco frecuente, este se traslada automáticamente a la capa de acceso frecuente. Funciona bien con datos de larga duración con patrones de acceso desconocidos o impredecibles.</li>
<li>
<p><strong>S3 Glacier</strong> (<a href="https://aws.amazon.com/es/s3/glacier/">https://aws.amazon.com/es/s3/glacier/</a>): es una clase de almacenamiento seguro, duradero y de bajo coste para archivar datos a largo plazo. Para que los costes se mantengan bajos, <em>S3 Glacier</em> proporciona tres opciones de recuperación (recuperación acelerada, estándar y masiva), que van desde unos pocos minutos a unas horas. Podemos cargar objetos directamente en <em>S3 Glacier</em> o utilizar políticas de ciclo de vida para transferir datos entre cualquiera de las clases de almacenamiento de S3 para datos activos y <em>S3 Glacier</em>.</p>
<div class="admonition info">
<p class="admonition-title">Política de ciclo de vida</p>
<p>Una <strong>política de ciclo de vida</strong> define qué va a pasar con los datos partiendo de su almacenamiento masivo en S3 estándar, pasando a uso poco frecuente y seguidamente a Glacier y finalmente para su eliminación, en base a plazos o métricas y reduciendo costes de forma automática.</p>
<p><figure style="align: center;">
    <img src="images/03politicaCicloVida.png">
    <figcaption>Política de ciclo de vida</figcaption>
</figure></p>
<p>Para ello, se puede monitorizar un bucket completo, un prefijo o una etiqueta de objeto, de manera que podamos evaluar los patrones de acceso y ajustar la política de ciclo de vida.</p>
</div>
</li>
<li>
<p><strong>S3 Glacier Deep Archive</strong>: es la clase de almacenamiento de menor coste en S3. Admite la retención a largo plazo y la preservación digital de datos a los que es posible que se acceda solo una o dos veces por año. Diseñado inicialmente los a sectores con niveles de regulación muy estrictos, como los servicios financieros, la sanidad y los sectores públicos, los cuales retienen conjuntos de datos durante un periodo de 7 a 10 años o más para cumplir los requisitos de conformidad normativa. También se puede utilizar para casos de uso de copias de seguridad y de recuperación de desastres. Todos los objetos almacenados en <em>S3 Glacier Deep Archive</em> se replican y almacenan en al menos tres zonas de disponibilidad geográficamente dispersas, y se pueden restaurar en 12 horas.</p>
</li>
</ul>
<h3 id="buckets">Buckets<a class="headerlink" href="#buckets" title="Permanent link">&para;</a></h3>
<p>Amazon S3 almacena los datos en buckets, los cuales son los bloques básicos donde se estructura la información, actuando como contenedores lógicos de objetos. Los buckets son esencialmente el prefijo de un conjunto de archivos y, como tales, deben tener un <ins>nombre único</ins> en todo Amazon S3 a nivel mundial.</p>
<p>Podemos controlar el acceso a cada bucket mediante mecanismos de control de acceso (<em>ACL</em>) que pueden aplicarse tanto a objetos individuales como a los buckets, es decir, quién puede crear, eliminar y enumerar objetos en el bucket. También podemos obtener registros de acceso al bucket y a sus objetos, además de elegir la región geográfica donde <em>Amazon S3</em> almacenará el bucket y su contenido. Para cargar los datos (como fotos, vídeos o documentos), primero hemos de crear un bucket en una región de AWS y, a continuación, cargar casi cualquier cantidad de objetos en el bucket (los objetos pueden ocupar hasta 5TB).</p>
<figure style="float: right;">
    <img src="images/03s3severo8a.png" width="450">
    <figcaption>Creamos el bucket</figcaption>
</figure>

<p>Cuando creamos un bucket en S3, este se asocia a una región de AWS específica. Cuando almacenamos datos en el bucket, estos se almacenan de forma redundante en varias instalaciones de AWS dentro de la región seleccionada. <em>S3</em> está diseñado para almacenar los datos de forma duradera, incluso en el caso de producirse una pérdida de datos simultánea en dos instalaciones de AWS.</p>
<p>Por ejemplo, vamos a crear un <em>bucket</em> dentro de la región <code>us-east-1</code> con el nombre <code>s3severo8a</code> (recuerda que el nombre debe ser único y en minúsculas, así como evitar las tildes, ñ, etc...).</p>
<figure style="float: right;">
    <img src="images/03s3severo8a-labs3.png" width="450">
    <figcaption>Cargando el bucket</figcaption>
</figure>

<p>Para almacenar un objeto en <em>S3</em>, debemos cargarlo en un bucket.</p>
<p>Para cargar un archivo, una vez elegido el bucket sobre el que queremos cargar, simplemente arrastrando el <a href="resources/labS3.csv">fichero</a>, éste se subirá a <em>S3</em> (también podemos establecer permisos sobre los datos y cualquier metadato).</p>
<p>Ya hemos comentado que un objeto está compuesto por los datos y cualquier metadato que describa a ese archivo, incluida la dirección URL. En nuestro caso su URL sería <a href="https://s3severo8a.s3.amazonaws.com/labS3.csv">https://s3severo8a.s3.amazonaws.com/labS3.csv</a></p>
<div class="admonition warning">
<p class="admonition-title">Acceso denegado</p>
<p>Si intentamos acceder al fichero mediante la URL obtendremos un fichero XML indicándonos que no tenemos permisos para visualizar el recurso:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&lt;Error&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="nt">&lt;Code&gt;</span>AccessDenied<span class="nt">&lt;/Code&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nt">&lt;Message&gt;</span>Access<span class="w"> </span>Denied<span class="nt">&lt;/Message&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="nt">&lt;RequestId&gt;</span>ZCZ6XBHYC8C8SYSH<span class="nt">&lt;/RequestId&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="nt">&lt;HostId&gt;</span>btHdjBYCmNFdndkpfKiOKlSoxN0yvn+kkGoFWYGKr4F2oLYE0OkxpwlxLLlafoH+uvHFRpS4fw0=<span class="nt">&lt;/HostId&gt;</span>
<span class="linenos" data-linenos="6 "></span><span class="nt">&lt;/Error&gt;</span>
</code></pre></div>
</div>
<p><em>S3</em> administra automáticamente el almacenamiento detrás de cada bucket a medida que aumenta la cantidad de datos. <em>S3</em> también es escalable, lo que permite gestionar un volumen elevado de solicitudes. No es necesario aprovisionar el almacenamiento ni el rendimiento, y solo se facturará por lo que utilicemos.</p>
<h3 id="casos-de-uso">Casos de uso<a class="headerlink" href="#casos-de-uso" title="Permanent link">&para;</a></h3>
<p>Esta flexibilidad para almacenar una cantidad prácticamente ilimitada de datos y para acceder a ellos desde cualquier lugar convierte a <em>S3</em> en un servicio adecuado para distintos casos:</p>
<ul>
<li>Como ubicación para cualquier dato de aplicación, ya sea nuestra propia aplicación hospedada <em>on-premise</em>, como las aplicaciones de EC2 o mediante servidores en otros <em>hostings</em>. Esta característica puede resultar útil para los archivos multimedia generados por el usuario, los registros del servidor u otros archivos que su aplicación deba almacenar en una ubicación común. Además, como el contenido se puede obtener de manera directa a través de Internet, podemos delegar la entrega de contenido de nuestra aplicación y permitir que los clientes la consigan ellos mismos.</li>
<li>Para el alojamiento web estático. <em>S3</em> puede entregar el contenido estático de un sitio web, que incluye <em>HTML</em>, <em>CSS</em>, <em>JavaScript</em> y otros archivos.</li>
<li>Para almacenar copias de seguridad de sus datos. Para una disponibilidad y capacidad de recuperación de desastres incluso mejores, <em>S3</em> puede hasta configurarse para admitir la replicación entre regiones, de modo que los datos ubicados en un bucket de <em>S3</em> en una región puedan replicarse de forma automática en otra región de <em>S3</em>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Diferencias entre EBS y S3</p>
<ul>
<li><em>EBS</em> solo se puede utilizar cuando se conecta a una instancia <em>EC2</em> y se puede acceder a Amazon <em>S3</em> por sí solo.</li>
<li><em>EBS</em> no puede contener tantos datos como <em>S3</em>.</li>
<li><em>EBS</em> solo se puede adjuntar a una instancia <em>EC2</em>, mientras que varias instancias <em>EC2</em> pueden acceder a los datos de un bucket de <em>S3</em>.</li>
<li><em>S3</em> experimenta más retrasos que Amazon EBS al escribir datos.</li>
</ul>
<p>Así pues, es el usuario o el diseñador de la aplicación quien debe decidir si el almacenamiento de Amazon S3 o de Amazon EBS es el más apropiado para una aplicación determinada.</p>
</div>
<h3 id="costes">Costes<a class="headerlink" href="#costes" title="Permanent link">&para;</a></h3>
<p>Con <em>S3</em>, los costes específicos varían en función de la región y de las solicitudes específicas que se realizan. Solo se paga por lo que se utiliza, lo que incluye gigabytes por mes; transferencias desde otras regiones; y solicitudes <code>PUT</code>, <code>COPY</code>, <code>POST</code>, <code>LIST</code> y <code>GET</code>. Como regla general, solo se paga por las transferencias que cruzan el límite de su región, lo que significa que no paga por las transferencias entrantes a <em>S3</em> ni por las transferencias salientes desde <em>S3</em> a las ubicaciones de borde de Amazon CloudFront dentro de esa misma región.</p>
<p>Para calcular los costes de <em>S3</em> hay que tener en cuenta:</p>
<ol>
<li>
<p>Clase de almacenamiento y cantidad almacenada:</p>
<ul>
<li>El almacenamiento estándar está diseñado para proporcionar 99,999.999.999% (11 nueves) de durabilidad y 99,99% (4 nueves) de disponibilidad. Por ejemplo, los primeros 50 TB/mes cuestan 0,023$ por GB.</li>
<li>El almacenamiento Estándar - Acceso poco frecuente ofrece la misma durabilidad de 99,999.999.999% (11 nueves) de <em>S3</em>, pero con 99,9% (3 nueves) de disponibilidad en un año concreto. Su precio parte desde los 0,0125$ por GB.</li>
<li>Y si elegimos el almacenamiento poco frecuente pero en una única zona, el precio pasa a ser de 0,01$ por GB.</li>
<li>Si fuese a la capa <em>Glacier</em>, con una opción de recuperación de 1 minutos a 12 horas el precio baja a 0,004$ por GB.</li>
<li>Finalmente, con <em>Glacier Deep Archive</em> (archivos que se recuperan 1 o 2 veces al año con plazos de recuperación de 12 horas) baja hasta 0,000.99$ por GB</li>
</ul>
</li>
<li>
<p>Solicitudes: se consideran la cantidad y el tipo de las solicitudes. Las solicitudes GET generan cargos (0,000.4$ por cada 1.000 solicitudes) a tasas diferentes de las de otras solicitudes, como <code>PUT</code> y <code>COPY</code> (0,005$ cada 1.000 solicitudes).</p>
</li>
<li>
<p>Transferencia de datos: se considera la cantidad de datos transferidos fuera de la región de <em>S3</em>, los datos salientes, siendo el primer GB gratuito y luego comienza a facturar a 0,09$ por GB. La transferencia entrante de datos es gratuita.</p>
</li>
</ol>
<p>La información actualizada y detallada se encuentra disponible en <a href="https://aws.amazon.com/es/s3/pricing/">https://aws.amazon.com/es/s3/pricing/</a>.</p>
<h3 id="sitio-web-estatico">Sitio web estático<a class="headerlink" href="#sitio-web-estatico" title="Permanent link">&para;</a></h3>
<p>Vamos a hacer un caso práctico de uso de S3. AWS permite que un <em>bucket</em> funcione como un sitio web estático. Para ello, una vez creado el <em>bucket</em>, sobre sus propiedades, al final de la página, podemos habilitar el alojamiento de web estáticas.</p>
<p>Para este ejemplo, primero creamos un <em>bucket</em> llamado <code>severo8a-web</code>.</p>
<p>A continuación subiremos nuestro archivo <a href="resources/siteEstatico.zip">siteEstatico.zip</a> descomprimido al bucket.</p>
<p>Para que la web sea visible, tenemos que modificar los permisos para que no bloquee el acceso público. Así pues, en la pestaña de permisos del bucket deshabilitamos todas las opciones.</p>
<figure>
    <img src="images/03bucketPermisos.png">
    <figcaption>Haciendo el bucket público</figcaption>
</figure>

<p>Una vez que tenemos el bucket visible, tenemos que añadir una política para acceder a los recursos del mismo (la política también la podemos crear desde el generador de políticas que tenemos disponible en la misma página de edición):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Política</label><label for="__tabbed_1_2">Asistente para generar la política</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Policy1633602259164&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PublicReadGetObject&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="nt">&quot;Principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3:GetObject&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:s3:::severo8a-web/*&quot;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">]</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><figure>
    <img src="images/03s3-policy-editor.png">
    <figcaption>Editor de políticas</figcaption>
</figure></p>
</div>
</div>
</div>
<p>Tras ello, sólo nos queda configurar el <em>bucket</em> como un sitio web. Para ello, en las propiedades, en la parte final de la página, tenemos la opción de <em>Alojamiento de sitios web estáticos</em>, la cual debemos habilitar y posteriormente nos mostrará la URL de acceso a nuestro sitio web, en nuestro caso en <a href="http://severo8a-web.s3-website-us-east-1.amazonaws.com/">http://severo8a-web.s3-website-us-east-1.amazonaws.com/</a></p>
<figure>
    <img src="images/03s3-sitioweb.png">
    <figcaption>Sitio Web público</figcaption>
</figure>

<p>Más información en <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteHosting.html">https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteHosting.html</a></p>
<h3 id="s3-select">S3 Select<a class="headerlink" href="#s3-select" title="Permanent link">&para;</a></h3>
<p><em>Amazon S3 Select</em> permite utilizar instrucciones SQL sencillas para filtrar el contenido de los objetos de Amazon S3 y recuperar exactamente el subconjunto de datos que necesitemos. Si utilizamos <em>S3 Select</em> para filtrar los datos, podemos reducir la cantidad de datos que Amazon transfiere, lo que reduce también los costes y la latencia para recuperarlos.</p>
<p>Admite los formatos <em>CSV</em>, <em>JSON</em> o <em>Apache Parquet</em>, ya sea en crudo o comprimidos con <em>GZIP</em> o <em>BZIP2</em> (solo para objetos <em>CSV</em> y <em>JSON</em>), así como objetos cifrados del lado del servidor.</p>
<p>Las expresiones SQL se pasan a Amazon S3 en la solicitud. Amazon S3 Select es compatible con un subconjunto de SQL. Para obtener más información sobre los elementos SQL compatibles es recomendable consultar la <a href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/s3-glacier-select-sql-reference.html">referencia SQL de S3</a>.</p>
<figure style="float: right;">
    <img src="images/03s3select.png" width="500">
    <figcaption>Cargando el bucket</figcaption>
</figure>

<p>Por ejemplo, si trabajamos sobre el bucket que habíamos creado, tras seleccionarlo, en las <em>Acciones de objeto</em>, elegiremos la opción de <em>Consultar con S3 Select</em> , y si no queremos configurar nada, podemos ejecutar una consulta de tipo <em>select</em> desde la propia ventana mediante el botón <em>Ejecutar consulta SQL</em>.</p>
<p>Si nos fijamos en la imagen, se crea una tabla ficticia denominada <code>s3object</code> que referencia al documento cargado. Si queremos hacer referencia a columna, podemos hacerlo por su posición (por ejemplo <code>s._1</code> referencia a la primera columna) o por el nombre de la columna (en nuestro caso, <code>s.VendorID</code>). Es importante marcar la casilla <em>Excluir la primera línea de CSV datos</em> si la primera fila de nuestro CSV contiene etiquetas a modo de encabezado.</p>
<!-- SELECT * FROM s3object s WHERE s.VendorID='1' LIMIT 5 -->

<p>Si pulsamos sobre el botón de <em>Agregar SQL desde plantillas</em>, podremos seleccionar entre algunas consultas predefinidas (contar, elegir columnas, filtrar los datos, etc...).</p>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>Los datos que hemos cargado en el ejemplo están relacionados con trayectos de taxis.
1. El campo <code>VendorID</code> tiene dos posibles valores: 1 y 2: ¿ Cuantos viajes han hecho los <em>vendor</em> de tipo 1?
2. Cuando el campo <code>payment_type</code> tiene el valor 1, está indicando que el pago se ha realizado mediante tarjeta de crédito. A su vez, el campo <code>total_amount</code> almacena el coste total de cada viaje ¿Cuantos viajes se han realizado y cuanto han recaudado los trayectos que se han pagado mediante tarjeta de crédito?</p>
<p>Para transformar el tipo de un campo, se emplea la función <code>cast</code> .Por ejemplo si queremos que interprete el campo total como de tipo float haríamos <code>cast(s.total as float)</code> o si fuera entero como <code>cast(s.total as int)</code>.</p>
<p><!-- SELECT count(*), sum(cast(s.total_amount as float)) FROM s3object s WHERE s.payment_type='1' --> </p>
<p>Puedes probar también con los datos almacenados en un <a href="resources/labS3.csv.gz">fichero comprimido</a>.</p>
</div>
<p>La consola de Amazon S3 limita la cantidad de datos devueltos a 40 MB. Para recuperar más datos, deberemos utilizar la AWS CLI o la API REST.</p>
<p>Más información en <a href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/selecting-content-from-objects.html">https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/selecting-content-from-objects.html</a>.</p>
<h3 id="acceso">Acceso<a class="headerlink" href="#acceso" title="Permanent link">&para;</a></h3>
<p>Podemos obtener acceso a <em>S3</em> a través de la consola, de la interfaz de línea de comandos de AWS (CLI de AWS) o del SDK de AWS. También se puede acceder a <em>S3</em> de forma privada a través de una VPC.</p>
<p>Por ejemplo, como ya conoces la AWS CLI, podríamos utilizarla para crear un <em>bucket</em>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Creando un bucket</label><label for="__tabbed_2_2">Resultado</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">aws s3api create-bucket --bucket s3severo8a-cli --region us-east-1</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="nt">&quot;Location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/s3severo8a-cli&quot;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Otra forma es el acceso a los datos de los bucket directamente a través de servicios REST, mediante puntos de enlace que admiten el acceso HTTP o HTTPS.</p>
<p>Para facilitar la integración de S3 con otros servicios, S3 ofrece <strong>notificaciones de eventos</strong> que permiten configurar notificaciones automáticas cuando se producen determinados eventos, como la carga o la eliminación de un objeto en un bucket específico. Estas notificaciones se pueden enviar o utilizarse para desencadenar otros procesos, como funciones de AWS Lambda.</p>
<h3 id="seguridad">Seguridad<a class="headerlink" href="#seguridad" title="Permanent link">&para;</a></h3>
<p>Por defecto, todos los buckets de S3 son privados y solo pueden acceder los usuarios a los que se les concede acceso explícitamente.
Normalmente utilizaremos S3 para almacenar datos que utiliza una aplicación que se ejecuta fuera de S3 o para hacer copias de seguridad de información confidencial. Para estos casos de uso comunes, el acceso público a los buckets que contienen datos nunca debe ser otorgado.</p>
<p>Disponemos de varias herramientas y posibilidades para controlar el acceso a los buckets u objetos de S3:</p>
<ul>
<li>Uso del bloqueo de acceso público, la cual anula de manera sencilla cualquier otra política o permisos de objetos.</li>
<li>La escritura de políticas IAM que indiquen los usuarios o roles que pueden acceder a buckets y objetos específicos.</li>
<li>La escritura de políticas de bucket que definan el acceso a buckets u objetos específicos, ya sea para conceder acceso entre cuentas de AWS o para conceder acceso público o anónimo a los datos de Amazon S3. Se utiliza cuando el usuario o el sistema no pueden autenticarse mediante IAM.</li>
<li>Creación de puntos de acceso de S3, los cuales son nombres de alojamiento únicos que aplican permisos y controles de red definidos para las solicitudes que se realizan a través de él. Podemos crear puntos de acceso individualizados con nombres y permisos personalizados para cada aplicación que accede a los datos.</li>
<li>Configuración de listas de control de acceso (ACL). Se utilizan con menos frecuencia (las ACL preceden a la IAM). Si utilizamos ACL, se recomienda no establecer un acceso muy permisivo.</li>
</ul>
<div class="admonition caution">
<p class="admonition-title">La seguridad es crítica</p>
<p>Recuerda que hay que controlar el acceso a los recursos, y en especial a S3. Si lo dejamos abierto, cualquier podrá introducir datos con el consiguiente incremento en el coste.
También podemos cifrar los datos en tránsito y habilitar el cifrado del lado del servidor en nuestros objetos.</p>
</div>
<h2 id="s3-y-python">S3 y Python<a class="headerlink" href="#s3-y-python" title="Permanent link">&para;</a></h2>
<p>AWS ofrece diferentes interfaces para interactuar con S3, siendo Python una de las formas. A continuación, vamos a crear una serie de scripts en nuestra máquina local que accede, añade o recupere objetos de S3.</p>
<p>Para autenticarnos en AWS desde nuestro sistema local, recuerda que necesitas copiar las credenciales de acceso en <code>~/.aws/credentials</code> (también puedes hacerlo mediante las <a href="02aws.html#variablesEntorno">variables de entorno</a>).</p>
<p>Para acceder a AWS desde <em>Python</em>, <em>Amazon</em> ofrece el <a href="https://aws.amazon.com/es/sdk-for-python/">SDK Boto3</a>. Antes de utilizarlo, lo instalaremos mediante:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">pip install boto3</span>
</code></pre></div>
<p>Podéis consultar toda la información relativa a <em>Boto3</em> en su documentación oficial en
<a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html">https://boto3.amazonaws.com/v1/documentation/api/latest/index.html</a></p>
<p>Existen dos posibilidades para acceder a AWS mediante <em>Boto3</em>:</p>
<ul>
<li><strong>Recursos</strong>: representan un interfaz orientado a objetos de AWS, de manera que cada recurso contendrá un identificador, unos atributos y un conjunto de operaciones. Un ejemplo de recurso es el <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html#object">S3</a>. Más información sobre recursos en la <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/resources.html">documentación oficial</a>.</li>
<li><strong>Clientes</strong>: ofrecen un interfaz de bajo nivel que se mapea 1:1 con el API de cada servicio. Los clientes se generan a partir de la definición JSON del servicio. Más información en la <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/clients.html">documentación oficial</a>.</li>
</ul>
<p>En resumen, los recursos son una abstracción a más alto nivel de los servicios AWS que los clientes. Se recomienda el uso de los recursos al no tener que preocuparse de cómo se realiza por debajo la comunicación e interacción con los servicios. Sin embargo, a día de hoy no hay recursos para todos los servicios AWS, y por ello, en ocasiones no queda otra opción que utilizar los clientes.</p>
<p>Para demostrar las diferencias, vamos a ver cómo podemos realizar algunas operaciones haciendo uso del cliente o del recurso (en estos ejemplos nos vamos a centrar en el servicio S3 - <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html</a>.):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:4"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><input id="__tabbed_3_4" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Buckets de un usuario</label><label for="__tabbed_3_2">Elementos de un bucket</label><label for="__tabbed_3_3">Creación de un bucket</label><label for="__tabbed_3_4">Eliminación de un recurso/bucket</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><span class="filename">s3-buckets.py</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1"># Opción 1</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Buckets mediante resource:&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">s3resource</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">buckets</span> <span class="o">=</span> <span class="n">s3resource</span><span class="o">.</span><span class="n">buckets</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">buckets</span><span class="p">:</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">bucket</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="c1"># Opción 2</span>
<span class="linenos" data-linenos="11 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Buckets mediante el cliente:&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span><span class="n">s3client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="13 "></span><span class="n">response</span> <span class="o">=</span> <span class="n">s3client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()</span>
<span class="linenos" data-linenos="14 "></span><span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Buckets&#39;</span><span class="p">]:</span>
<span class="linenos" data-linenos="15 "></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">bucket</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">s3-bucket-objects.py</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;s3severo8a&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<span class="linenos" data-linenos="6 "></span>    <span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">s3-create-bucket.py</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1"># Opción 1 - resource</span>
<span class="linenos" data-linenos=" 4 "></span><span class="n">s3r</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">bucket</span> <span class="o">=</span> <span class="n">s3r</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;s3severo8a-python-resource&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">bucket</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1"># Opción 2 - cliente</span>
<span class="linenos" data-linenos=" 9 "></span><span class="n">s3c</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="10 "></span><span class="n">response</span> <span class="o">=</span> <span class="n">s3c</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span>
<span class="linenos" data-linenos="11 "></span>    <span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;s3severo8a-python-client&#39;</span>
<span class="linenos" data-linenos="12 "></span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">s3-delete.py</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="n">s3r</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="n">bucket</span> <span class="o">=</span> <span class="n">s3r</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;s3severo8a-python-resource&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="c1"># Elimina todos los objetos del bucket</span>
<span class="linenos" data-linenos="7 "></span><span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="linenos" data-linenos="8 "></span><span class="c1"># Elimina el bucket</span>
<span class="linenos" data-linenos="9 "></span><span class="n">bucket</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="caso-de-uso-1-comunicacion-con-s3">Caso de uso 1 - Comunicación con S3<a class="headerlink" href="#caso-de-uso-1-comunicacion-con-s3" title="Permanent link">&para;</a></h3>
<p>Vamos a trabajar con el archivo <a href="resources/datosPeliculas.json">datosPeliculas.json</a> el cual contiene un listado de películas con las que trabajaremos en las siguientes sesiones.</p>
<p>Primero vamos a ver cómo podemos subir el archivo a S3 mediante Python:</p>
<div class="highlight"><span class="filename">upload-movies-s3.py</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">ficheroUpload</span> <span class="o">=</span> <span class="s2">&quot;datosPeliculas.json&quot;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="n">nombreBucket</span> <span class="o">=</span> <span class="s2">&quot;s3severo8a-boto3&quot;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1"># Opción 1 - resource</span>
<span class="linenos" data-linenos=" 7 "></span><span class="n">s3r</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1"># 1.1 mediante upload_file</span>
<span class="linenos" data-linenos="10 "></span><span class="n">bucket</span> <span class="o">=</span> <span class="n">s3r</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">nombreBucket</span><span class="p">,</span> <span class="s1">&#39;datosSubidosR1.txt&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span><span class="n">bucket</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">ficheroUpload</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="c1"># 1.2 mediante put</span>
<span class="linenos" data-linenos="14 "></span><span class="nb">object</span> <span class="o">=</span> <span class="n">s3r</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">nombreBucket</span><span class="p">,</span> <span class="s1">&#39;datosSubidosR2.txt&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="15 "></span><span class="nb">object</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">Body</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;Ejemplo de datos binarios&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="c1"># Opción 2 - cliente</span>
<span class="linenos" data-linenos="18 "></span><span class="n">s3c</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="c1"># 2.1 mediante upload_file</span>
<span class="linenos" data-linenos="21 "></span><span class="n">response</span> <span class="o">=</span> <span class="n">s3c</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">ficheroUpload</span><span class="p">,</span> <span class="n">nombreBucket</span><span class="p">,</span> <span class="s2">&quot;datosSubidosC1.json&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="c1"># 2.2 mediante upload_fileobj</span>
<span class="linenos" data-linenos="24 "></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ficheroUpload</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="linenos" data-linenos="25 "></span>    <span class="n">s3c</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nombreBucket</span><span class="p">,</span> <span class="s2">&quot;datosSubidosC2.json&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="c1"># Cliente: Ejemplo de como crear un objeto y añadirle contenido desde Python</span>
<span class="linenos" data-linenos="28 "></span><span class="n">s3c</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Body</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;Ejemplo de datos binarios&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="29 "></span>               <span class="n">Bucket</span><span class="o">=</span><span class="n">nombreBucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="s2">&quot;datosSubidosC3&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Si lo que queremos es descargar un recurso de S3 para tenerlo en nuestro sistema local haremos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1"># Opción 1 - descarga</span>
<span class="linenos" data-linenos=" 4 "></span><span class="n">s3c</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">s3c</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;s3severo8a-boto3&#39;</span><span class="p">,</span> <span class="s1">&#39;datosPeliculas.json&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span>                 <span class="s1">&#39;datosDescargados.json&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1"># Opción 2 - Abrimos el fichero y metemos el contenido</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;fichero.json&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="linenos" data-linenos="10 "></span>    <span class="n">s3c</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">(</span><span class="s1">&#39;s3severo8a-boto3&#39;</span><span class="p">,</span> <span class="s1">&#39;datosPeliculas.json&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
<h3 id="caso-de-uso-2-s3select-desde-python">Caso de uso 2 - S3Select desde Python<a class="headerlink" href="#caso-de-uso-2-s3select-desde-python" title="Permanent link">&para;</a></h3>
<p>En este caso, vamos a coger datos de películas de un dataset público disponible en <a href="https://www.kaggle.com/sankha1998/tmdb-top-10000-popular-movies-dataset">https://www.kaggle.com/sankha1998/tmdb-top-10000-popular-movies-dataset</a></p>
<p>El contenido del dataset es similar a:</p>
<div class="highlight"><span class="filename">TMDb_updated.csv</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span>,title,overview,original_language,vote_count,vote_average
<span class="linenos" data-linenos="2 "></span>0,Ad Astra,&quot;The near future...&quot;,en,2853,5.9
<span class="linenos" data-linenos="3 "></span>1,Bloodshot,&quot;After he ...&quot;,en,1349,7.2
<span class="linenos" data-linenos="4 "></span>2,Bad Boys for Life,&quot;Marcus and Mike ...&quot;,en,2530,7.1
</code></pre></div>
<p>Una vez descargado <a href="resources/TMDb_updated.csv">TMDb_updated.CSV</a>, vamos a cargar la información en S3 dentro del bucket <code>s3severo8a-boto3</code>.</p>
<h4 id="s3select">S3Select<a class="headerlink" href="#s3select" title="Permanent link">&para;</a></h4>
<p>Podemos realizar una consulta desde <em>Python</em> para automatizar un proceso ETL utilizando <em>S3Select</em> para recuperar el subconjunto de los datos, en concreto, información sobre las películas que tienen más de 10.000 votaciones.</p>
<div class="admonition info">
<p class="admonition-title">S3Select vs AWS Athena</p>
<p>Este tipo de procesamiento es más cómodo realizarlo mediante AWS Athena, el cual sí que permite realizar <em>join</em> entre diferentes datasets. <em>S3Select</em> sólo permite trabajar con una única tabla.</p>
</div>
<p>Para ello, mediante S3Select ejecutaremos la consulta <code>SELECT s.title, s.overview, s.vote_count, s.vote_average FROM s3object s WHERE cast(s.vote_count as int)&gt; 10000</code> y almacenaremos el resultado en un nuevo CSV dentro del mismo bucket:</p>
<div class="highlight"><span class="filename">s3select.py</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1"># 1.- Realizamos la consulta mediante S3Select</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">resp</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">select_object_content</span><span class="p">(</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;s3severo8a-boto3&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;TMDb_updated.csv&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="n">ExpressionType</span><span class="o">=</span><span class="s1">&#39;SQL&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span>    <span class="n">Expression</span><span class="o">=</span><span class="s2">&quot;SELECT s.title, s.overview, s.vote_count, s.vote_average FROM s3object s WHERE cast(s.vote_count as int)&gt; 10000&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span>    <span class="n">InputSerialization</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CSV&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;FileHeaderInfo&quot;</span><span class="p">:</span> <span class="s2">&quot;USE&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span>                                <span class="s1">&#39;AllowQuotedRecordDelimiter&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="linenos" data-linenos="13 "></span>                        <span class="s1">&#39;CompressionType&#39;</span><span class="p">:</span> <span class="s1">&#39;NONE&#39;</span><span class="p">},</span>
<span class="linenos" data-linenos="14 "></span>    <span class="n">OutputSerialization</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CSV&#39;</span><span class="p">:</span> <span class="p">{}},</span>
<span class="linenos" data-linenos="15 "></span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="c1"># 2.- Unimos los datos que vamos recibiendo en streaming</span>
<span class="linenos" data-linenos="19 "></span><span class="n">registros</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;title,overview,vote_count,vote_average</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos="20 "></span><span class="k">for</span> <span class="n">evento</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s1">&#39;Payload&#39;</span><span class="p">]:</span>
<span class="linenos" data-linenos="21 "></span>    <span class="k">if</span> <span class="s1">&#39;Records&#39;</span> <span class="ow">in</span> <span class="n">evento</span><span class="p">:</span>
<span class="linenos" data-linenos="22 "></span>        <span class="n">registros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evento</span><span class="p">[</span><span class="s1">&#39;Records&#39;</span><span class="p">][</span><span class="s1">&#39;Payload&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="c1"># 3.- Generamos el contenido en un String</span>
<span class="linenos" data-linenos="25 "></span><span class="n">file_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">registros</span><span class="p">)</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="c1"># 4.- Creamos un nuevo objeto en S3</span>
<span class="linenos" data-linenos="28 "></span><span class="n">s3</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Body</span><span class="o">=</span><span class="n">file_str</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;s3severo8a-boto3&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="29 "></span>              <span class="n">Key</span><span class="o">=</span><span class="s2">&quot;TMDb_filtered.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="referencias">Referencias<a class="headerlink" href="#referencias" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://aws.amazon.com/es/ebs/">Amazon EBS</a></li>
<li><a href="https://aws.amazon.com/es/s3/">Amazon S3</a></li>
<li><a href="https://aws.amazon.com/es/efs/">Amazon EFS</a></li>
<li><a href="https://realpython.com/python-boto3-aws-s3/">Python, Boto3, and AWS S3: Demystified</a></li>
<li><em>S3Select</em> mediante <em>Python</em>: <a href="https://towardsdatascience.com/ditch-the-database-20a5a0a1fb72">Ditch the Database</a></li>
</ul>
<h2 id="actividades">Actividades<a class="headerlink" href="#actividades" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>(<abbr title="Gestiona sistemas de almacenamiento y el amplio ecosistema alrededor de ellos facilitando el procesamiento de grandes cantidades de datos sin fallos y de forma rápida.">RA5075.2</abbr> / <abbr title="Se ha determinado la importancia de los sistemas de almacenamiento para depositar y procesar grandes cantidades de cualquier tipo de datos rápidamente.">CE5.2a</abbr> / 1p) Realizar el módulo 7 (Almacenamiento) del curso <a href="https://awsacademy.instructure.com/courses/30530/">ACF de AWS</a>.</p>
</li>
<li>
<p>(<abbr title="Gestiona sistemas de almacenamiento y el amplio ecosistema alrededor de ellos facilitando el procesamiento de grandes cantidades de datos sin fallos y de forma rápida.">RA5075.2</abbr> / <abbr title="Se ha determinado la importancia de los sistemas de almacenamiento para depositar y procesar grandes cantidades de cualquier tipo de datos rápidamente.">CE5.2a</abbr>, <abbr title="Se ha determinado que se pueden almacenar tantos datos como se desee y decidir cómo utilizarlos más tarde.">CE5.2d</abbr>  / 1p) Sigue el ejemplo de la web estática para crear un bucket que muestre el contenido como un sitio web. Adjunta una captura de pantalla del navegador una vez puedas acceder a la web.</p>
</li>
<li>
<p>(<abbr title="Gestiona sistemas de almacenamiento y el amplio ecosistema alrededor de ellos facilitando el procesamiento de grandes cantidades de datos sin fallos y de forma rápida.">RA5075.2</abbr> / <abbr title="Se ha determinado la importancia de los sistemas de almacenamiento para depositar y procesar grandes cantidades de cualquier tipo de datos rápidamente.">CE5.2a</abbr> / 1p) A partir del ejemplo de <em>S3 Select</em>, realiza las consultas propuestas en la autoevaluación (utilizando el archivo comprimido) y realiza capturas donde se vea tanto la consulta como su resultado.</p>
</li>
<li>
<p>(<abbr title="Gestiona sistemas de almacenamiento y el amplio ecosistema alrededor de ellos facilitando el procesamiento de grandes cantidades de datos sin fallos y de forma rápida.">RA5075.2</abbr> / <abbr title="Se ha determinado la importancia de los sistemas de almacenamiento para depositar y procesar grandes cantidades de cualquier tipo de datos rápidamente.">CE5.2a</abbr> / 1p) Realiza los casos de uso 1 y 2 de interacción desde <em>Python</em> con S3, adjuntando capturas tanto del código <em>Python</em> como del bucket en S3.</p>
</li>
</ol>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        <a href='https://ko-fi.com/T6T8GWT9N' title='Invítame a un café en ko-fi.com' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Invítame a un café en ko-fi.com' /></a>
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="Me encantan estos apuntes" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Los apuntes son mejorables" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Gracias por tu tiempo. Si quieres me puedes <a href='https://ko-fi.com/T6T8GWT9N'>invitar a un café en ko-fi</a>.
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              ¡Gracias por tu colaboración! Ayúdame a mejorar los apuntes enviándome un mail a <a href="mailto:a.medrano@edu.gva.es">a.medrano@edu.gva.es</a> con tus comentarios.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie" >
        
          
          <a href="02aws.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: AWS">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                AWS
              </div>
            </div>
          </a>
        
        
          
          <a href="04computacion.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: EC2">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                EC2
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2022-2023 Aitor Medrano - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Consentimiento de cookie</h4>
<p>Esta página de apuntes utiliza cookies para reconocer las visitas, medir la efectividad de la documentación y averiguar si encuentras aquello que buscas o cómo has llegado a estos apuntes. Con tu consentimiento, me ayudas a mejorar estos materiales.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Aceptar</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestionar cookies</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "content.code.annotate", "announce.dismiss", "toc.follow", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>